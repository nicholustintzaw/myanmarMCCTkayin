---
title: \vspace{8cm} \LARGE{Program Evaluation of Maternal and Child Cash Transfer (MCCT) program in Kayin State, Myanmar}
subtitle: "Draft Report"
author: ""
date: '`r format(Sys.Date(), "%d %B %Y")`'
fontsize: 12pt
geometry: margin=2cm
documentclass: article
classoption: a4paper
bibliography: bibliography.bib
link-citations: TRUE
links-as-notes: FALSE
colorlinks: TRUE
linkcolor: blue
citecolor: blue
urlcolor: blue
lot: true
lof: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)

knitr::knit_hooks$set(document = function(x) {
  sub('\\usepackage[]{color}', '\\usepackage{xcolor}', x, fixed = TRUE)
  }
)

if(!require(rgdal)) install.packages("rgdal")
if(!require(rgeos)) install.packages("rgeos")
if(!require(raster)) install.packages("raster")
if(!require(maps)) install.packages("maps")
if(!require(knitr)) install.packages("knitr")
if(!require(kableExtra)) install.packages("kableExtra")
if(!require(magrittr)) install.packages("magrittr")
if(!require(FNN)) install.packages("FNN")
if(!require(ggplot2)) install.packages("ggplot2")
if(!require(ggmap)) install.packages("ggmap")
if(!require(stringr)) install.packages("stringr")
if(!require(remotes)) install.packages("remotes")
if(!require(openxlsx)) install.packages("openxlsx")
if(!require(RColorBrewer)) install.packages("RColorBrewer")
if(!require(magrittr)) install.packages("magrittr")
if(!require(lubridate)) install.packages("lubridate")

if(!require(myanmarMCCTdata)) install_github("validmeasures/myanmarMCCTdata")
if(!require(drlib)) install_github("dgrtwo/drlib")

waterLadder <- c("#4575b4", "#74add1", "#ffffbf", "#feb24c", "#ec7014")
sanitationLadder <- c("#1a9850", "#a6d96a", "#ffffbf", "#feb24c", "#ec7014")
handwashLadder <- c("#cab2d6", "#feb24c", "#ec7014")

themeSettings <- theme_bw() +
  theme(panel.border = element_rect(colour = "gray50",
                                    size = 0.5),
        panel.grid.major = element_line(linetype = 1,
                                        size = 0.1,
                                        colour = "gray90"),
        panel.grid.minor = element_line(linetype = 0),
        strip.background = element_rect(colour = "gray50",
                                        fill = "gray70"),
        strip.text = element_text(colour = "white", size = 16),
        legend.text = element_text(size = 16),
        legend.key = element_rect(linetype = 0),
        legend.key.size = unit(14, "points"),
        legend.position = "top",
        axis.title = element_text(size = 16),
        axis.text.x = element_text(size = 14),
        axis.text.y = element_text(size = 14),
        axis.ticks = element_line(colour = "gray50", size = 0.5))
```

\newpage

# Acronyms and abbreviations {-}

```{r acronym, echo = FALSE, eval = TRUE}
x <- c("CPI", "CSI", "CCSI", "DSW", "FCS", "FCS-N", "GAD", "GAM", "HAZ", "HFES", "HIV/AIDS", "IFA", "IYCF", "LCSI", "MAM", "MCCT", "MDD-W", "MMK", "MSWRR", "MN-NPAN", "MUAC", "NNC", "NSPSP", "ODK", "PLW", "PPI", "RCT", "RD", "RHC", "SAM", "SBCC", "SRHC", "STD", "TEM", "UNICEF", "WASH", "WAZ", "WHO", "WHZ", "WFP")

y <- c("Community Partners International",
       "Coping strategies index",
       "Consumption-based coping strategies index",
       "Department of Social Welfare",
       "Food consumption score",
       "Food consumption score - nutrition",
       "General Administration Department",
       "Glocal Acute Malnutrition",
       "Height-for-age z-score",
       "Household food expenditure share",
       "Human immunodeficiency virus/Acquired immune deficiency syndrome",
       "Iron-folic acid",
       "Infant and young child feeding",
       "Livelihoods-based coping strategies index",
       "Moderate acute malnutrition",
       "Mother and child cash transfer",
       "Minimum dietary diversity for women",
       "Myanmar Kyatt",
       "Ministry of Social Welfare, Relief and Resettlement",
       "Multi-sector National Plan of Action for Nutrition",
       "Midde upper arm circumference",
       "National Nutrition Council",
       "National Social Protection Strategic Plan",
       "Open Data Kit",
       "Pregnant or lactating women",
       "Poverty probability index",
       "Randomised controlled trial",
       "Regression discontinuity",
       "Rural health centre",
       "Severe acute malnutrition",
       "Social behavioural change communication",
       "Sub-rural health centre",
       "Sexually-transmitted disease",
       "Technical error of measurement",
       "United Nations Children's Fund",
       "Water, sanitation and hygiene",
       "Weight-for-age z-score",
       "World Health Organization",
       "Weight-for-height z-score",
       "World Food Programme")

xy <- data.frame(x, y)

kable(x = xy,
      caption = NULL,
      booktabs = TRUE,
      row.names = FALSE,
      col.names = c("Acronym/Abbreviation", "Definition"),
      escape = TRUE,
      format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position", "striped")) %>%
  kableExtra::column_spec(column = 2, width = "8cm") %>%
  kableExtra::row_spec(row = 0, bold = TRUE) 
```

\newpage

# Executive summary {-}

Since 2017, the Ministry of Social Welfare, Relief and Resettlement (MSWRR) started rolling out a Maternal and Child Cash Transfer (MCCT) program in specific states including Kayin State through the Department of Social Welfare, in line with the National Social Protection Strategic Plan (NSPSP) and the Multi-Sector National Plan of Action for Nutrition (MS-NPAN). The program aims to improve nutritional outcomes for all mothers and children during the first 1000 days of life by ensuring that pregnant women and mothers have improved practices on nutrition, infant, and young child feeding, and health-seeking behaviors. The program aims to provide universal coverage to social behavior change communication (SBCC) and a maternal and child cash transfer (MCCT) of 15,000 MMK per month for all pregnant women and mothers with children under 2 years of age. In Kayin State, recruitment into the programme started on the 1st of October 2018. From the 6th of August to the 20th of September 2019, a study that included a baseline population-based survey and a study cohort of mothers and children was initiated. The study aims to assess key household, child health and nutrition and maternal health and nutrition indicators to describe the existing situation in Kayin State and to assess the impact of the MCCT in acheiving its goals of reducing childhood undernutrition, specifically stunting, in Kayin State. This report presents the results of this study.

The results of the population-based baseline survey in Kayin State indicate that child undernutrition specifically stunting/stuntedness and underweight is one of the highest in Myanmar with children in hard-to-reach areas (which also tend to be the poorest in the state) being the worst affected in the state. Results from child health and nutrition related indicators describes the situation in the state of poor infant and young child feeding and breastfeeding practices and low coverage and access to child health services such as immunisation as immediate factors that may explain the level of child undernutrition in the state. In addition, maternal health as proxied by services for mothers during pregnancy, on giving birth and post-pregnancy indicate mostly disparate results of relative better access among wealthy women and lesser access for poorer women. Overall, most mothers who access these maternal health services pay out-of-pocket hence exacerbating the wealth disparity in access to these services. Maternal undernutrition as proxied by maternal wasting by MUAC is, however, low though dietary diversity of women is not optimal.

More distal factors such as food insecurity as proxied by food consumption, coping strategies, household food expenditure share are not at critical levels for the state on aggregate but wealth disparities with regard to these food security indicators support the idea that poverty is a distal driver of child undernutrition in the state. Water and sanitation and hygiene indicators, another distal factor impacting on child health and nutrition, though on aggregate are acceptable are much worse for poor households.

Treatment-seeking for childhood illnesses in Kayin state is to partly explained by wealth disparity though results seem to indicate a more complex mechanism of decisionmaking within households that the current results cannot completely explain.

It is within this context that the MCCT program is embedded aiming to address primarily the distal factor of poverty and its correlates so that households can address immediate and intermediate factors of access to nutritious food and access to services which in turn can impact on the child undernutrition situation specifically stunting. However, the results of the population-based survey indicate that current coverage of the MCCT program in Kayin state is too low to possibly make an impact.

The results from the cohort of intervention and control mother and children recruited for the evaluation component of the study seem to support this concern. Whilst there is beginning discontinuity noted between intervention and control groups after one year of intervention, the difference is not significant enough to be able to associate this effect on the MCCT program. This can be partly explained by a relatively short period of exposure to be able to make an impact on stunting/stuntedness. But it is also explained by the low coverage achieved by the program currently.

Given this, it is critical that the MCCT program achieve high levels of coverage as an immediate point of action. Secondly, other factors that a cash transfer program will most likley not impact should be considered for other types of interventions. This includes efforts to improve water, sanitation and hygiene services particularly in hard-to-reach and in poor households. Social and behavioural change communication, a component of the current intervention, also has a role in impacting on diet-related practices specifically on infant and young child feeding and in addition it should include key messages on appropriate hygiene practices and treatment-seeking practices based on nuanced and contextualised understanding of existing practices and behaviours.

\newpage

# Background {#background}

Kayin State remains one of the less developed areas of Myanmar and is home to some of the most remote and isolated communities in the country with decades long armed conflicts between Ethnic Armed Organizations and Myanmat Tatmadaw. As confirmed by Myanmar Demographic and Health Survey conducted in 2015, children in Kayin State are more likely to be malnourished than the average child in Myanmar, with the prevalence of stunting being particularly high [@MinistryofHealthandSports-MoHS/Myanmar2017]. Moreover, certain maternal and child health indicators are among the lowest in Myanmar, specifically concerning contraception prevalence, antenatal care visits as well as immunization rates amongst children 12 and 23 months of age.

Since 2017, the Ministry of Social Welfare, Relief and Resettlement (MSWRR) started rolling out a Maternal and Child Cash Transfer (MCCT) program in Chin, Rakhine, Kayah, and Kayin States through the Department of Social Welfare, in line with the National Social Protection Strategic Plan (NSPSP) and the Multi-Sector National Plan of Action for Nutrition (MS-NPAN). The program aims to improve nutritional outcomes for all mothers and children during the first 1000 days of life by ensuring that pregnant women and mothers have improved practices on nutrition, infant, and young child feeding, and health-seeking behaviors. The program aims to provide universal coverage to social behavior change communication (SBCC) and a maternal and child cash transfer (MCCT) of 15,000 MMK per month for all pregnant women and mothers with children under 2 years of age.

# Study aims and objectives {#objectives}

To provide a basis for measuring and evaluating the outcomes and impact of the MCCT program over time by estimating current levels of indicators related to:

1. Nutrition based on anthropometric measurements of maternal and child weight, height, and mid-upper arm circumference (MUAC) in Kayin State;

2. Behaviors related to nutrition, infant and young child feeding (IYCF), and health-seeking among mothers in Kayin State; and,

3. Knowledge related to health, nutrition, and hygiene among pregnant women and mothers with under five children in Kayin state.

## Research Questions {#research-questions}

1. What are the current levels of indicators related to nutrition, infant and young child feeding (IYCF), and health-seeking behaviors of mothers and under 5 children in Kayin State?

2. What is the impact of the MCCT program on child stunting in Kayin State?

3.  What is the impact of the MCCT program on maternal nutritional status in Kayin State?

## Study Output {#study-outputs}

1. Estimates of the current levels of indicators related to nutrition, IYCF, and health-seeking behaviors among mothers and their children under 5 in Kayin State

2. Estimate of prevalence of childhood stunting in the study cohort of children exposed to the MCCT program and those who are not in Kayin State

3. Estimate of prevalence of maternal nutritional status in the study cohort of mothers exposed to the MCCT program and those who are not in Kayin State

# Methods {#methods}

## Study design {#design}

The study included two primary components:

### Survey of selected households, villages, and townships {#study1}

This was composed of three surveys.

1. **Representative household survey** - The baseline survey was designed for the measurement and evaluation of outcomes over time by estimating the current levels of indicators related to nutrition, IYCF, and health-seeking behaviors. The baseline study was conducted during the roll-out of MCCT program in Kayin State.

2. **Village profiles** - Village level demographics, assets, and conditions were assessed in each of the selected villages in Kayin State.

3. **Township profiles** - Township profiles were developed from the township-level data collected from all townships in Kayin State from which sampled villages were from.

This component of the study was designed to address research question 1 (Section \@ref(research-questions)). The survey results were used to provide context to the results of the second study component (see Section \@ref(study2)).

#### Sampling frame {#sampling-frame}

To assess the various outcome indicators for the assessment[^1], a two-stage cluster sample survey was implemented. The **first stage sample** was a sample of about 75 villages out of the total villages in Kayin State stratified into 1) *urban*, 2) *rural* and 3) *hard-to-reach* areas. The **second stage sample**, also called the within-community sample, was a sample of households from the selected villages with mothers with children less than 5 years old. The second stage sample was selected using the list of household with children under 5 years of age from each village as identified by township General Administrative Unit (GAD) whenever possible.

A total of about 14 households with pregnant mothers and mothers with children less than 5 years were sampled in each village. If a small community was selected that was likely to have fewer than the required number of eligible respondents, all eligible households and persons in that community are sampled by moving door-to-door. If a household had more than one mother with children less than 5 years of age, mother with children less than 2 years of age was prioritized for data collection. If there were more than one mother with children less than 2 years of age, one of these mothers was selected randomly. Only the under 5 children of the index mother were included in the anthropometric measurements if there were more than one mother with under 5 children in the same household. In addition, all pregnant mothers present in the household of the respondents were measured for middle upper arm circumference (MUAC).

#### Sample size estimation {#sample-size-1}

Using childhood stunting as index indicator for sample size calculations, the sample size needed to detect a change of mean HAZ from 1.432 in Kayin State[^2] to -0.932 with a calculated standard deviation 1.14406[^2] was calculated. This is an equivalent drop in stunting prevalence of about 10%. This equates to a sample size of 137 children less than 5 years old. Assuming a design effect for a cluster survey of 2, this sample size was inflated to 274. A sample size of 274 respondents was needed for each strata (*urban*, *rural* and *hard-to-reach*) in Kayin State giving a total of 822 respondents in total. Assuming a non-response rate of 20% overall, a total of 330 respondents was the target sample for each strata in Kayin State.

As described in the sampling frame above, a total of 25 villages per strata and 14 respondent mothers with children less than 5 years old were the target number of samples and a total of 350 respondents in each strata was the overall target in order to achieve at least 274. In Kayin state, a total of 1050 respondents was the overall target. This is anticipated to be more than enough sample size as per calculations above. For the selected respondents who were not present at the time of data collection, two revisits were conducted with the respondent classified as a non-responder after two unsuccessful attempts.

### Quasi-experimental cohort study {#study2}

As part of a longitudinal, quasi-experimental evaluation design, the baseline survey included a cohort of mothers and their children selected through specific study eligibility criteria based on eligibility and receipt of the services and benefits of the MCCT program. Once recruited, this cohort was assessed on appropriate indicators related to nutrition, IYCF and health-seeking behaviours at baseline. This same cohort will then be assessed at endline on the same set of appropriate and relevant indicators to detect any difference between those receiving benefits from the MCCT from those who are not based on a regression discontinuity analytical approach (see Section \@ref(regression-discontinuity)).

This component of the study provides a statistically robust comparison between those exposed to the MCCT program and those who are not hence detecting the possible impact that the program has on a specific set of impact indicators.

Given the universal nature of the MCCT program and the need to create effective treatment and comparison groups to detect program impact, this study component used a similar regression discontinuity (RD) design as was developed and used for the MCCT evaluation in Chin State, but with distinct changes that address limitations of the latter [@MinistryofSocialWelfareReliefandResettlement2018]. This design was made possible by the fact that there is a specific cut-off point for program eligibility. Ultimately, the program (treatment) effect can be detected as a discontinuity in the regression line around this cut-off which in this case is a specific date that determines eligibility. The design is *quasi-experimental*, since treatment and comparison groups were not selected at random but based on predefined characteristics.

#### Eligibility criteria {#eligibility}

Eligibility criteria depended on three factors:

* Date of start of recruitment into the MCCT program (1st October 2018)

* Date when the recruitment for study participants will occur (6th August 2019)

* Receipt of MCCT benefits

The optimal bandwidth of ages of the children to include in the study needed to be as close to the cut-off date as possible such that the ages of the children in the control and intervention groups will be roughly similarly distributed. This meant up to one month before and after the recruitment date of 1st October 2018. Given this, the following eligibility criteria were applied:

**Control group**

Following are the criteria for eligibility to the control group of the study:

1. Women who gave birth on/after 1 September 2018 but before 1 Oct 2108 (i.e. 1 month before the MCCT registration cut-off)

2. Women who were pregnant/gave birth after 1 Oct 2018 but have not been recruited into program

**Intervention group**

The criteria for eligibility to the intervention group of the study was women who were pregnant on or after 1 Oct 2018 and have been recruited into the program.

#### Sample size and selection {#sample-size-2}

The RD design effect was factored in for sample size calculations. This design effect was used to inflate standard randomized controlled trials (RCT) sample sizes in order to account for the RD design. The RD design effect was primarily influenced by the distribution of characteristics of the cut-off variable (i.e. running variable) [@Bor2014]. Previous literature advise that if the running variable is normally distributed around the cut-off, then the design effect is approximately 2.75. If the running variable is uniformly distributed around the cut-off, the design effect is 4, and if it is bimodal in distribution, then the design effect can go up to 5 [@Schochet2009].

Given that the running variable for this study is the start date of registration in relation to pregnancy, it was expected that there would be various peaks in number of pregnancies at specific time points following a general seasonal pattern not necessarily related to the cut-off date. The distribution is therefore likely multi-modal. So an assumption of at least 5 design effect for this RD design was taken into account.

Using prevalence of stunting as the index indicator for calculating sample size and using mean change in height-for-age z-score (HAZ) as the specific variable to use for assessing change, the same sample size calculation as in the survey was arrived at which was 137 for controls and 137 for intervention (total of 274) for each state.
However, given the very narrow bandwidth of inclusion into the study used (one month before and after the program start), it is likely that the universe population from which to select the cohort is quite small and that the total sample size of 274 is likely requiring an exhaustive sampling of all children born within the specified periods above. In this case, the inflation factor to account for design effect was not considered to be relevant given that an exhaustive sample will be drawn to begin with. Hence the 274 sample size for Kayin State was set as the target sample size.

#### Sample recruitment

Sample recruitment utilised a full list or registry of births one month before and after the 1st of October 2018. As an exhaustive sample was needed, all fforts were undertaken to identify and recruit into the study including engagement with the DSW in listing out and finding these births across Kayin state.

## Data collection

Data was collected using an electronic data entry system based on the **Open Data Kit (ODK)** standard that runs on the Android operating software (OS) platform for mobile devices. The study instrument was encoded into the electronic data entry system platform and was served out of a secure aggregate server hosted by ONA[^3]. Each data collector was provided with a tablet running on Android OS that was configured with the ODK application that receives the electronic data form. All measurements and answers by respondents were then recorded on the tablets and transmitted to the remote server whenever there was a mobile and/or wireless internet signal. This data collection system was not reliant on internet connection as the data collection could be performed offline, with the completed e-questionnaires saved on the interviewers’ tablets. An internet connection was needed only when finalized encoded forms were ready to submit to the remote server, and this submission was done at regular intervals and timed when there was available internet connection for the data collectors. The survey teams aimed to submit forms on a daily basis.

### Questionnaire design:

Structured questionnaires for the household survey, village profiles, and township profiles were in English and translated into local languages. For the household survey, all questions and responses were translated into written Myanmar, Pwo Karen, and Sgaw Karen. The data collector had the option to switch from one language to another on the tablet. The household survey also included anthropometric measurements for weight, height and MUAC for all pregnant women, mothers who have recently given birth, and every child up to five years of age in selected households. A separate form was developed for the anthropometric measurements.

The village profile questionnaire assessed various village level characteristics relevant to the study such as number of and distances to nearby markets, education, and health facilities; presence of community groups (e.g., Village Health Committees) and their functionality; presence of community volunteers (e.g., auxiliary midwives and community health workers); access and quality of water and sanitation facilities; and general agricultural practices.

The township profile questionnaire collected data on the township’s population, geography, and governance, with summaries of key nutrition indicators.

All approved questionnaires were back-translated into English to ensure that appropriate translation was done with discrepancies between language versions discussed and resolved between the study team and translators. Prior to the start of data collection, the household survey questionnaire was pilot tested to understand how well the wording and content, context effects, and interface design of the instruments performed in an actual survey setting and were revised as necessary. Respondents for field testing were purposively sampled from the same population as the baseline assessment (e.g., mothers from the study area, village leaders). The recommended minimum of 32 respondents were recruited for field testing of the household questionnaire. Field testing was iterative with changes to the data collection instruments implemented immediately and the revised instrument was re-tested. Field testing involved feedback from the following three sources:

* Respondents: During field testing of the questionnaire, respondents were asked first to respond to the questions and then to re-interpret each question in their own words to learn how respondents understood the question and how they came up with their answers. The study team members probed for potential sources of ambiguity/confusion including word choice and translation, as well as the relevance and comprehensiveness of responses options to each question.
 
* Interviewers: The study team members provided feedback on the questionnaire content to confirm that questions and responses were clear in the context of data collection. Field testing also examined how well the e-questionnaire and tablet functioned in the field. Senior study team members collected data from enumerators for the purpose of field testing using a standardized debriefing questionnaire.

* Design and content experts: Members of the study team reviewed the data collected during the field testing phase to check whether the responses correspond to the meaning of individual questions and the overall goals of the study.

## Training of enumerators {#training}

Different trainings were conducted based on the skill that was being trained on and the type of personnel that was being trained.

### Anthropometric Training {#anthro-training}

Recruited anthropometrists received an intensive 5-day training from an expert anthropometric measurement trainer with supervision by National Nutrition Center (NNC) and nutrition advisor(s). The training covered an introduction to the purpose of the study, nutritional indicators , anthropometry, accuracy and validity of measurements, utilization and equipment of the measurement tools (e.g., MUAC tape, weighing scales, measuring board), and electronic data entry. The training emphasized practice and standardization of the anthropometric measurements to be used during the study according to methods adapted from the [WHO’s Multicentre Growth Reference Study](https://www.who.int/childgrowth/mgrs/en/) [@DeOnis2004] and [INTERGROWTH-21 Project](https://intergrowth21.tghn.org) [@Ismail2013] anthropometric training protocols. 

During the training, women of reproductive age and children under five years of age were invited to participate as subjects, and each subject was measured twice by the expert trainer serving as gold standard and twice by each trainee. To assess inter- and intra-rater precision, the technical error of measurement (TEM) was calculated, with an acceptable TEM for an individual trainee defined as no more than twice that of the expert [@ulijaszek_kerr_1999]. Accuracy was assessed by calculating mean differences between the gold standard trainer and the trainee. Only participants who meet the required standard for accuracy and precision were selected for anthropometric data collection during the baseline assessment. The training was conducted in Myanmar language.

### Interviewer and Supervisor Training {#interview-training}

All supervisors and enumerators received an intensive 5-day training from study team members that covered the purposes of the study, informed consent procedures, the questionnaire guides and responses, electronic data entry, referral protocols for severe acute malnutrition, roles and responsibilities of all field staff, data quality assurance procedures, problem-solving, and conflict-sensitive approaches to data collection. The performance of trainees were assessed post-training using a written assessment based on didactic lessons, as well as performance during practice sessions. Separate trainings were conducted for the supervisors and interviewers in Kayin State.

### Additional Supervisor Training {#add-training}

All supervisors received an additional 3 days of training from study team members that covered screening, random sampling method to identify respondents, quality control in the field, quality control of data entry and uploading, team management, and logistics.

## Survey management and supervision {#survy-management}

During data collection, 1 field supervisor supervised 1 team each composed of 4 enumerators and 2 anthropometrists. Each team was expected to complete 14 household interviews and one village profile per day depending on feasibility. Community Partners International worked with the Central NNC and State/Region Nutrition Teams and nutrition experts in developing a referral guideline and standard operating procedures to ensure that any women or children who were measured during the study and suspected of having severe acute malnutrition (SAM) were immediately referred to an appropriate health provider. Survey teams were provided with contact information of the nearest health providers to ensure timely referral. Alerts to refer women and children were programmed into the e-questionnaire on the ODK platform, based on WHO criteria for SAM.

## Quality control {#quality-control}

Quality control procedures throughout the assessment design, implementation, and analysis included:

* Translation, back-translation, and pilot testing as described above;

* Development of standard operating procedures and training manuals. CPI developed and distributed guidelines on data collection procedures, including the questionnaire and anthropometry methods, to all members of the data collection team;

* Training of data collectors where supervisors, enumerators, and anthropometrists practiced administering the questionnaire and checking and correcting questionnaires for accuracy and completeness. The performance of anthropometrists and data collectors were assessed in terms of confidence, independence, and reliability during practice sessions during the trainings, and based on results of an evaluation at the end of the training period;

* Anthropometric devices were calibrated and supervisors re-assessed some of the anthropometric measurements at intervals. Maintenance and quality check of all the other devices were done regularly as per the manufacturer’s instructions. Data collection was coordinated and continuously supervised by field supervisors and senior researchers.

* The data collection tool was designed in such a way that any potential errors related to data entry were minimized by programmatically adding data entry checks that raise appropriate prompts to the data collector based on the potential error detected. The data collector was not allowed by the system to continue to the next field until the error has been corrected. For the anthropometric measurements, a test for the feasibility of the measurements taken based on the child’s age and sex was implemented. If the measurement was above or below a certain threshold of feasible values, the system prompted the data collector to check their recording of the measurement, and to perform the measurement again. This approach was expected to pick up at least 90% of possible errors due to data entry and measurement errors. to complement this, an algorithm was added to randomly ask the data collector to repeat the measurement, even if the result of the first measurement was plausible. This approach was expected to pick up at least 90% of possible errors due to data entry and measurement errors.

* The Data Manager reviewed the data in real-time as they were uploaded to the server. This was done using a purpose-built application called `myanmarMCCTchecks`[^4] that allows for routine data checks automatically. In most cases, the error was detected and corrected immediately due to the data quality assurance measures built into the ODK platform, but if necessary, the interviewer was requested to revisit the respondent. In this case, the corrected questionnaire was uploaded and the wrong one deleted, so that only correct, checked records were stored in the database.

## Data processing and analysis {#analysis}

### Tools and methods {#processing-tools}

Data handling, processing, analysis and reporting were done using **version 3.6.1** of the [R Language for Statistical Computing](https://cran.r-project.org)[^5] [@R2019]. The R package **myanmarMCCTdata** was developed to support the handling, processing and analysis of data collected for the study. The package includes functions to retrieve data from the [ONA](https://ona.io) server database, to appropriately structure datasets, to check and clean data, to recode data to respective indicator sets, to estimate indicators and to perform appropriate comparative analysis specified by the analysis[^6] [@myanmarData2019]. The package uses several other R packages that provide additional functions for data processing, analysis and reporting[^7].

The main motivation for using R was to achieve transparent and reproducible research between the study collaborators and with external reviewers and/or readers. Developing the **myanmarMCCTdata** R package is the first step towards this aim of transparency and reproducibility as any collaborator and/or reviewer can easily retrieve the same codebase for data handling, processing and analysis used by the primary researchers. The second step was writing reports (including this report) using R itself using a seamless integration between data anlysis and reporting. This was achieved using R Markdown [@rmarkdown2018] for producting reports which included code chunks of how the data processed using **myanmarMCCTdata** functions were analysed to produce the results reported here. This report and the analysis herein, can be reviewed and reproduced by collaborators and reviewers by following instructions given [here](https://github.com/validmeasures/myanmarMCCTkayin).

### Indicator estimation {#indicator-estimation}

Data was processed and recoded based on standard and established indicator definitions whenever available. For some indicators, modifications to standard definitions were made based on information requirements by stakekholders or study-specific definitions were established in order to achieve analysis requirements. Several recode functions were developed in R through the **myanmarMCCTdata** package for this purpose. The following indicator sets were assessed:

#### MCCT program coverage

Given that actual exposure to the intervention is a key factor to assessing impact of the MCCT program, coverage was deemed important to assess and estimate. Based on eligibility criteria for MCCT, households were assessed whether they qualified for inclusion in MCCT. Households were also asked whether they were in the MCCT and receiving its benefits. These data were then used to assess program coverage defined as:

$$ \text{MCCT program coverage} ~ = ~ \frac{\text{Eligible households in MCCT program}}{\text{Total eligible households}} $$

This indicator was only estimated for the population survey sample component of the study.

#### Poverty probability index (PPI) {#ppi}

The [Poverty Probability Index (PPI)](https://www.povertyindex.org) is a poverty measurement tool that is statistically-sound, yet simple to use. The answers to 10 country-specific questions about a household’s characteristics and asset ownership are scored to compute the likelihood that the household is living below a certain poverty line or definition[@InnovationsforPovertyAction2019]. PPI is used to identify households who are most likely to be poor or vulnerable to poverty. 

The Myanmar MCCT survey collected answers to the 10 Myanmar-specific questions on household characteristics and asset ownership responses which were used to determine the household's PPI score based on the Myanmar national poverty line. The household's PPI score was then matched to poverty line/definition-specific lookup tables to determine the household's poverty probability. The matching of the PPI score to lookup tables was facilitated using the PPI lookup tables for Myanmar from the `ppitables` package [@Guevarra2019] for R.

#### Water, sanitation and hygiene {#wash}

Recoding for indicators for water, sanitation and hygiene (WASH) were based on standard indicator definitions provided by WHO and UNICEF [@WHOUNICEFJointMonitoringProgrammeforWaterSupplyandSanitation:2018vr; @WorldHealthOrganization:2006vv].

The following drinking water access indicators were assessed:

* Access to improved drinking water sources (regardless of collection time[^8])

* Access to unimproved drinking water sources only (unprotected dug well and unprotected spring)

* Drinking water from surface water (directly from a river, dam, lake, pond, stream, canal/irrigation canal)

* Probably safe drinking water based on appropriate water treatment method applied to water

These drinking water access indicators have been assessed for each of the three seasons (summer, rainy and winter season) experienced in Kayin and Kayin states.

In addition to drinking water access, the following drinking water use and storage behaviour was also assessed:

* Use of a water container/pot that is clean, covered and with a cup and handle

The following indicators on access to sanitation facilities were assessed:

* Access to improved sanitation facilities that are not shared with other households[^9]

* Access to improved sanitation facilities that are shared with other households[^10]

* Access to unimproved sanitation facilities

* Use of open defecation

The following indicators on access to handwashing facilities were assessed:

* Access to handwashing facility on premises with soap and water[^11]

* Access to handwashing facilities on premises without soap and water[^12]

* No handwashing facilities

In addition, handwashing practices and behaviours were also assessed.

#### Food consumption score (FCS) {#fcs}

The **Food Consumption Score (FCS)** is an index developed by the World Food program (WFP) in 1996  [@VulnerabilityAssessmentandMappingWorldFoodProgramme:2008ti]. The **FCS** is a household level indicator that aggregates food group diversity and frequency over the past 7 days. These food groups are then weighted according to their relative nutritional value. This means that food groups that are nutritionally-dense such as animal products are given greater weight than those containing less nutritionally dense foods such as tubers. The weights are then added up to come up with a household score which are then used to classify households into either poor, borderline, or acceptable food consumption. The **FCS** is a measure of quantity of caloric intake.

A brief questionnaire was used to ask respondents about the frequency of their households’ consumption of eight different food groups over the previous seven days. The eight food groups are: main staples; pulses; vegetables; fruit; meat/fish; milk; sugar; and, oil. The frequency of consumption of these different food groups consumed by a household during the 7 days before the survey was then used to calculate a weighted diet diversity score for each household using the food group weights (Table \@ref(tab:fcsWeights)) by multiplying the reported 7-day frequencies with the food group weights.

\newpage

Table: (\#tab:fcsWeights) FCS food groups and weights

+-----+----------------------------------------+-----------------+------------+
|     | **Food items**                         | **Food groups** | **Weight** |
+:===:+========================================+=================+===========:+
| 1   | Maize , maize porridge, rice, sorghum, | Main staples    | 2          | 
|     | millet pasta, bread and other cereals  |                 |            |
|     | Cassava, potatoes and sweet potatoes,  |                 |            |
|     | other tubers, plantains                |                 |            |
+-----+----------------------------------------+-----------------+------------+
| 2   | Beans, peas, groundnuts and cashew nuts| Pulses          | 3          |
+-----+----------------------------------------+-----------------+------------+
| 3   | Vegetables, leaves                     | Vegetables      | 1          |
+-----+----------------------------------------+-----------------+------------+
| 4   | Fruits                                 | Fruits          | 1          |
+-----+----------------------------------------+-----------------+------------+
| 5   | Beef, goat, poultry, pork, eggs and    | Meat and fish   | 4          |
|     | fish                                   |                 |            |
+-----+----------------------------------------+-----------------+------------+
| 6   | Milk yoghurt and other diary           | Milk            | 4          |
+-----+----------------------------------------+-----------------+------------+
| 7   | Sugar and sugar products, honey        | Sugar           | 0.5        |
+-----+----------------------------------------+-----------------+------------+
| 8   | Oils, fats and butter                  | Oil             | 0.5        |
+-----+----------------------------------------+-----------------+------------+
| 9   | Spices, tea, coffee, salt, fishpowder, | Condiments      | 0          |
|     | small amounts of milk for tea.         |                 |            |
+-----+----------------------------------------+-----------------+------------+

All the weighted consumption frequencies were then summed up per household to arrive at the FCS for the specific household. Then, Using the appropriate thresholds (Table \@ref(tab:fcsThresholds)), each household is classified accordingly based on their FCS.

Table: (\#tab:fcsThresholds) FCS classification thresholds

+-----------+--------------+
| **FCS**   | **Profiles** |
+===========+==============+
| 0 - 21    | Poor         |
+-----------+--------------+
| 21.5 - 35 | Borderline   |
+-----------+--------------+
| $>$ 35    | Acceptable   |
+-----------+--------------+

#### Food consumption score nutrition quality {#fcsn}

In addition to the standard FCS, WFP has devices a set of nutritional adequacy indicators that assess the nutrition quality of the household diet using the data provided by a slightly modified FCS questionnaire that disaggregates some of the food groups into sub-food groups known to contain vitamin A, protein and heme-iron. This is called the Food Consumption Score Nutrition Quality Analysis or FCS-N [@WorldFoodProgramme:2015tn]. The FCS-N focuses on three nutrients - vitamin A, iron and protein - to assess the nutrition adequacy of a household's diet. The FCS-N was calcualted by first aggregating the individual food groups into nutrient-rich food groups shown in Table \@ref(tab:fcs3).

```{r fcs3, echo = FALSE, eval = TRUE}
fcsnTable <- data.frame(c("Vitamin A-rich foods", "Protein-rich foods", "Heme iron-rich foods"),
                        c("Dairy, organ meat, eggs, orange vegetables, green leafy vegetables and orange fruits",
                          "Pulses, dairy, flesh meat, organ meat, fish and eggs",
                          "Flesh meat, organ meat, fish"))

knitr::kable(x = fcsnTable,
             caption = "Food groups classified by nutrients-of-interest for FCS-N",
             booktabs = TRUE,
             col.names = c("Nutrients", "Food Groups"),
             row.names = FALSE,
             escape = TRUE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position", "striped")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 2, width = "8cm")
```

Households were then classified by their frequency of consumption of the three nutrients of interest.

```{r fcs4, echo = FALSE, eval = TRUE}
fcsnCategories <- data.frame(c("Never", "Sometimes", "At least daily"),
                             c("0 days", "1-6 days", "7 or more days"))

knitr::kable(x = fcsnCategories,
             caption = "FCS-N categories based on nutrient-rich food groups consumption",
             booktabs = TRUE,
             col.names = c("Category", "No. of days of consumption"),
             row.names = FALSE,
             align = c("l", "r"),
             escape = TRUE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position", "striped")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE)
```

#### Coping strategy index {#csi}

The coping strategy index or CSI is a simple indicator that reveals how households manage or cope with shortfalls in food consumption. It is based on a list of possible behaviours that households may use as strategies for coping with conditions of having little or no food to eat [@Maxwell:2008vh]. The CSI combines the frequency by which a behaviour is utilised and the severity of each strategy used. There are two variations of the CSI. One assesses food consumption behaviours or strategies employed by the household in response to food insecurity (consumption-based CSI) while the other looks into the longer term, livelihoods-based strategies employed by households (livelihoods-based CSI).

The consumption-based coping strategy index (CCSI) used in this study was based on the reduced CSI questionnaire in order to allow for comparability between results for states and over time. The reduced CSI is based on 5 behaviours and corresponding severity weights for each as shown below.

```{r csi1, echo = FALSE, eval = TRUE}
csiTable <- data.frame(c("Rely on less preferred and less expensive food",
                         "Borrow food or rely on help from a relative or friend",
                         "Limit portion size at mealtimes",
                         "Restrict consumption by adults in order for small children to eat",
                         "Reduce number of meals eaten in a day"),
                       c(1, 2, 1, 3, 1))

knitr::kable(x = csiTable,
             caption = "Reduced CSI strategies/behaviours and their corresponding severity weights",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = c("Behaviours/Strategies", "Severity Weights"),
             escape = TRUE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position", "striped")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE)
```

The CCSI was calculated by multiplying the reported frequency of utilising a coping behaviour by the corresponding severity weight shown in Table \@ref(tab:csi1) and then taking the aggregate of these weighted scores. The CCSI is a continuous variable and the mean CCSI is used to describe the level of utilisation of coping strategies by households.

The livelihoods based coping strategies index or LCSI was used to better understand a household's longer term coping capacity to food insecurity. The respondent was asked to recall whether in the past 30 days their household has engaged in any of a set of 10 coping behaviours/strategies due to a lack of food or lack of money to buy food. These behaviours/categories were categorised into *stress* strategies, *crisis* strategies and *emergency* strategies. Based on the respondent's responses, their household was classified into the most severe strategy reported.

#### Household food expenditure share {#hfes}

Taking household expenditure as a proxy of income, the proportion of this expenditure spent on food is an indicator of household food security. A household that is more food insecure spends a bigger proportion of income on food. This indicator was calculated from the various monetary values of household spending grouped into food and non-food items. The share of household expenditure on food was estimated as follows:

$$ \text{Household food expenditure share} ~ = ~ \frac{\sum{\text{Household expenditure on food}}}{\sum{\text{Total household expenditure}}} ~ \times ~ 100 $$

&nbsp;

The following (see Table \@ref(tab:hfes1)) commonly used thresholds for classifying household food insecurity based on its food expenditure share were used:

```{r hfes1, echo = FALSE, eval = TRUE}
hfesTable <- data.frame(c("> 75%", "65-75%", "50-65%", "< 50%"),
                        c("Very vulnerable", "High food insecurity",
                          "Medium food insecurity", "Low food insecurity"))

knitr::kable(x = hfesTable,
             caption = "Commonly used HFES thresholds",
             booktab = TRUE,
             row.names = FALSE,
             col.names = c("HFES", "Food insecurity classification"),
             escape = TRUE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position", "striped"))
```

#### Child health {#chealth}

The child health indicators of the Myanmar MCCT program Evaluation include the following:

* Immunisation coverage;

* Period prevalence of childhood illnesses;

* Treatment-seeking behaviour for childhood illnesses; and,

* Prevalence of low birthweight

\newpage

**Immunisation coverage**

Coverage of the expanded program on immunisation (EPI) in Myanmar was based on the 2016 revised routine vaccination schedule when the pneumococcal and inactivated polio vaccine injection were introduced [@MoHMyanmar:2016wp] (see Table \@ref(tab:epi1)).

```{r epi1, echo = FALSE, eval = TRUE}
epiSchedule <- data.frame(c(rep("At birth", 2), rep("First Dose (2nd month)", 5), rep("Second dose (4th month)", 5), rep("Third dose (6th month)", 4), "Fourth dose (9th month)", "Fifth dose (18th Month)"),
                          c("BCG", "Hepatitis B", "BCG", "DPT, Hepatitis B, HiB", "Pentavalent 1", "Pneumococcal Conjugate Vaccine 1", "Oral Polio Vaccine 1", "DPT, Hepatitis B, HiB", "Pentavalent 2", "Pneumococcal Conjugate Vaccine 2", "Oral Polio Vaccine 2", "Inactivated Polio Vaccine", "DPT, Hepatitis, HiB", "Pentavalent 3", "Pneumococcal Conjugate Vaccine 3", "Oral Polio Vaccine 3", "Measles - Rubella", "Measles"))

knitr::kable(x = epiSchedule,
             caption = "Myanmar EPI Schedule 2016",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = c("Dose/Age", "Vaccine"),
             escape = TRUE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1)
```

Immunisation coverage indicators were calculated according to standard indicator definitions for children 12-23 months old [@WorldHealthOrganization:2005vp; @WorldHealthOrganization:1991uh; @HoshawWoodard:2001vm].

In addition to the standard indicators, age-appropriate immunisation coverage indicators were calculated based on Myanmar's EPI schedule. This was done to be able to maximise the full sample size of children 0-59 months old and to assess whether children at various ages receive the appropriate vaccination as per Myanmar EPI schedule. This is similar to approaches used by other researchers to assess age-appropriate immunisation coverage [@Kidane:2004uy; @Tadesse:2009dm; @Odutola:2015bm' @Dombkowski:2004bt]

\newpage

**Period prevalence of childhood illnesses and treatment-seeking**

Mothers' report of their children's illness specifically diarrhoea, fever[^13] or cough[^14] in the past 2 weeks provides the data for assessing the period prevalence of these childhood illnesses. Then, for those whose children has been ill, mothers' reported on whether treatment was sought, where it was sough and whether payment for treatment was required are used to assess treatment-seeking.

**Child birthweight**

Child birthweight was assessed based on either mother's report of child's birthweight or by recorded birthweight on child's health card. However, for purposes of accuracy, only the recorded birthweight on a health card was used to determine whether child was born with low birth weight. Children with birthweight of less than 2500 grams were classified as being born with low birthweight [@Woertman:1993hp; @Kelly:1997wa].

#### Child nutrition {#cnut}

The Myanmar MCCT program evaluation assessed the following child nutrition indicators:

**Childhood undernutrition**

Respective childhood undernutrition indices for childhood stunting, childhood wasting and childhood underweight were assessed. The height-for-age z-scores (HAZ), weight-for-height z-scores (WAZ) and weight-for-age z-scores of each 6-59 month old child in the sample were calculated using the using the R package **zscorer**[^15] [@zscorer2019]. Once z-score values were calculated, implausible z-score values were flagged using the WHO Growth Standards flagging criteria [@WorldHealthOrganizationWHO2006]. This was facilitated through the **nutricheckr** R package[^16] [@nutricheckr2019]. Further anthropometric data quality checks were performed using **nipnTK**[^17] [@nipnTK2019] R package which is based on an anthropometric data quality check toolkit developed and produced by the [National Information Platforms for Nutrition (NIPN)](http://www.nipn-nutrition-platforms.org) and funded by the European Union.

**Infant and young child feeding**

Infant and young child feeding indicators were assessed based on standard WHO and UNICEF definitions [@WorldHealthOrganization:2008vw]. The following indicators were assessed:

* Exclusive breastfeeding

* Early initiation of breastfeeding

* Minimum meal frequency

* Minimum dietary diversity

* Minimum acceptable diet

#### Maternal health {#mhealth}

A standard set of maternal health indicators covering *family planning*, *antenatal care*, *birth/delivery*, *postnatal care* and *newborn care* were assessed.

#### Maternal nutrition {#mnut}

The following maternal nutrition indicators were assessed:

**Maternal undernutrtion**

Maternal undernutrition was assessed based on MUAC. No consensus on MUAC cut-offs to determine maternal acute undernutrition have been identified and currently used cut-offs are specifically for pregnant and lactating women (PLW). Current research suggest that a cut-off of 23 cms as most appropriate for PLW [@Ververs:2013ee] instead of the commonly used 18.5 and 21 cms cutoffs in supplementation programmes for PLW. Given that the Myanmar MCCT dataset has data for women of reproductive age and not only PLW, the 18.5 and 21 cms cutoffs were used to assess levels of acute undernutrition in mothers (see Table \@ref(tab:manthro1)).

```{r manthro1, echo = FALSE, eval = TRUE}
manthroTable <- data.frame(c("< 21", "18.5 to 21", "< 18.5"),
                           c("Global acute undernutrition", "Moderate acute undernutrition", "Severe acute undernutrition"))

knitr::kable(x = manthroTable,
             caption = "MUAC cut-offs for maternal acute undernutrition",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = c("MUAC cut-offs", "Classification"),
             escape = TRUE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position", "striped")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE)
```

**Minimum dietary diversity for women**

Minimum dietary diversity for women or MDD-W is a dichotomous indicator of whether or not women 15–49 years of age have consumed at least five out of ten defined food groups the previous day or night. The proportion of women 15–49 years of age who reach this minimum in a population can be used as a proxy indicator for higher micronutrient adequacy, one important dimension of diet quality.

The indicator is calculated as follows:

$$ \text{MDD-W} = \frac{\text{Women 15-49 years of age who consumed 5 out of 10 food groups in the previous day or night}}{\text{Women 15-49 years of age}} $$

The ten food groups are:

1. Grains, white roots and tubers, and plantains
2. Pulses (beans, peas and lentils)
3. Nuts and seeds
4. Dairy
5. Meat, poultry and fish
6. Eggs
7. Dark green leafy vegetables
8. Other vitamin A-rich fruits and vegetables
9. Other vegetables
10. Other fruits

A fully reproducible data processing report can be reviewed [here](https://github.com/validmeasures/myanmarMCCTprocessing).

Using the the recoded data for indicators, population-level estimates with 95\% confidence limits of these indicators were calculated using standard classical estimation techniques. Proportion-type indicators were estimated by getting the proportion of those having the indicator of interest out of the total sample. The 95\% confidence limits for a proportiont-type indicator was estimated using the following formula:

$$
\begin{aligned}
\text{95\% confidence limits} & ~ = ~ p ~ \pm ~ 1.96 ~ \times ~ \sqrt{\frac{p ~ \times ~ (1 ~ - ~ p)}{n ^ 2}} \\
\\
where: & \\
\\
p & ~ = ~ \text{proportion estimate} \\
n & ~ = ~ \text{sample size}
\end{aligned}
$$

Indicators requiring the calculation of the population mean were estimated by calculating the mean of the sample for the indicator of interest. The 95\% confidence limits for a population mean indicator was estimated using the following formula:

$$
\begin{aligned}
\text{95\% confidence limits} & ~ = ~ \sigma ~ \pm ~ 1.96 ~ \times ~ \frac{SD}{\sqrt{n}} \\
\\
where: & \\
\\
\sigma & ~ = ~ \text{sample mean} \\
SD & ~ = ~ \text{standard deviation} \\
n & ~ = ~ \text{sample size}
\end{aligned}
$$

Indicator estimation was performed on the dataset for respondents for the population-based survey component of the study.

### Regression discontinuity {#regression-discontinuity}

Using data from respondents who quality for eligibility to the second component of the study, outcome nutrition indicators for chlidren and mothers were plotted by date of birth of the index child to demonstrate whether a regression discontinuity on the indicators of interest were demonstrable between those who are not benefitting from the MCCT program (on the basis of being born up to a month before the start of the program) and those who are (born up to a month after start of the program). Discontinuity was detected visually through the plot and statistically by testing any difference between the regression line of those in the control group to the regression line of those in the treatment group.

# Results {#results}

## Population-representative survey {#study1-results}

### MCCT program coverage {#mcct-coverage}

MCCT program coverage is extremely low for a program that is meant to universally cover children less than 24 months old. In urban areas, only 30% of eligible households are enrolled in MCCT. This proportion drops to a little over half in rural areas and in hard-to-reach areas. More eligible wealthier households are covered by the program compared to eligible poorer households. On average, eligible households received about 2 cash transfers to date.

```{r mcct1table, echo = FALSE, eval = TRUE}
tab <- create_mcct(df = hh, x = hhMembers) %>%
  recode_mcct() %>%
  create_unweighted_table(vars = c("mcct1", "mcct2"))

tab[ , 3] <- tab[ , 3] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "MCCT program coverage",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", 
                                     "",
                                     "In MCCT\n(\\%)", 
                                     "Number\nof\ncash\ntransfers\nreceived"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

MCCT is received mostly through the village head. For hard-to-reach areas and for poor households, the EHO also served as means of disbursements of MCCT (see Table \@ref(tab:mcct2table)). MCCT is used predominanlty for food and clothes and the mother is the usual decisionmaker for how to use the cash transfer (see Table \@ref(tab:mcct3table)).

```{r mcct2table, echo = FALSE, eval = TRUE}
tab <- create_mcct(df = hh, x = hhMembers) %>%
  recode_mcct() %>%
  create_unweighted_table(vars = paste("mcct3", letters[1:7], sep = ""))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "How MCCT is received",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", 
                                     "",
                                     "Mobile\nprogramme\n(\\%)", 
                                     "Wave\nmoney\n(\\%)",
                                     "Village\nhead/\nGAD\n(\\%)",
                                     "EHO\n(\\%)",
                                     "CBO\n(\\%)",
                                     "Midwife\n(\\%)",
                                     "Health\nstaff\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

```{r mcct3table, echo = FALSE, eval = TRUE}
tab <- create_mcct(df = hh, x = hhMembers) %>%
  recode_mcct() %>%
  create_unweighted_table(vars = c(paste("mcct5", letters[1:4], sep = ""),
                                   paste("mcct6", letters[1:3], sep = "")))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "How MCCT is used and who decides",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", 
                                     "",
                                     "Food\n(\\%)", 
                                     "Education\n(\\%)",
                                     "Housing\n(\\%)",
                                     "Clothes\n(\\%)",
                                     "Self\n(\\%)",
                                     "Husband\n(\\%)",
                                     "Other\nhousehold\nhead\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 2, 
                                          "MCCT used for..." = 4, 
                                          "Decided by..." = 3)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

### Poverty probability index {#ppi-results}

```{r ppiTable, echo = FALSE, eval = TRUE, fig.cap = "Poverty probability index by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ppiDF <- recode_ppi(df = hh)

ppiDF$geo_state <- factor(x = ppiDF$geo_state, 
                          levels = c("MMR002", "MMR003"),
                          labels = c("Kayah", "Kayin"))
ppiDF$geo_rural <- ifelse(ppiDF$geo_rural == 0, "Rural",
                     ifelse(ppiDF$geo_rural == 1, "Urban", "Hard-to-reach"))
ppiDF$geo_rural <- factor(x = ppiDF$geo_rural, levels = c("Urban", "Rural", "Hard-to-reach"))

ggplot(data = ppiDF[ppiDF$sample_component == 1 & ppiDF$geo_state == "Kayin", ], 
       mapping = aes(x = geo_rural, y = ppi)) +
  geom_boxplot(width = 0.5, outlier.size = 3,
               outlier.shape = 21, outlier.fill = "orange",
               outlier.colour = "orange", outlier.alpha = 0.7) +
  geom_jitter(width = 0.05, shape = 19, size = 3, colour = "#247BA0", alpha = 0.3) +
  scale_y_continuous(limits = c(0, 100), breaks = seq(from = 0, to = 100, by = 20)) +
  labs(x = "", y = "Poverty probability (%)") +
  themeSettings
```

Poverty probability of households across different locations in Kayin state show high variability ranging from as low as 1.4% to as high as a little over 95%. This distribution of poverty is roughly similar across urban, rural and hard-to-reach areas as seen in Figure \@ref(fig:ppiTable) above.

The poverty probabilities was primarily used to classify households into wealth quintiles which was subsequently used for wealth stratification of indicator results.

### Food consumption score {#fcs-results}

```{r fcs1table, echo = FALSE, eval = TRUE}
tab <- recode_fcs(df = hh) %>%
  create_unweighted_table(vars = c("fcs", "poor", "borderline", "acceptable"))

tab[ , 4:ncol(tab)] <- tab[ , 4:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Food consumption score",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", 
                                     "",
                                     "Mean\nfood\nconsumption\nscore", 
                                     "Poor\n(\\%)", 
                                     "Borderline\n(\\%)", 
                                     "Acceptable\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

Table \@ref(tab:fcs1table) presents FCS results by geographic location and by wealth quintiles. There is a clear geographic and wealth gradient with FCS as shown in Figure \@ref(fig:fcs1plot) and Figure \@ref(fig:fcs2plot). Poor FCS is at `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Hard-to-reach", "poor"], digits = 1), "%", sep = "")` in hard-to-reach areas whilst it is only `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Urban", "poor"], digits = 1), "%", sep = "")` and `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Rural", "poor"], digits = 1), "%", sep = "")` in urban and rural areas respectively. In the poor and poorest households, poor FCS is at `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Poor", "poor"], digits = 1), "%", sep = "")` and `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Poorest", "poor"], digits = 1), "%", sep = "")` respectively compared to no households with poor FCS in medium, wealthy and wealthiest households.

\newpage

```{r fcs1plot, echo = FALSE, eval = TRUE, fig.cap = "Food consumption score classification by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = poor:acceptable,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, 
                             levels = c("acceptable", "borderline", "poor"),
                             labels = c("Acceptable", "Borderline", "Poor"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS classification") +
  themeSettings
```

```{r fcs2plot, echo = FALSE, eval = TRUE, fig.cap = "Food consumption score classification by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS classification") +
  themeSettings
```

\newpage

### Food consumption score - nutrition {#fcsn-results}

```{r fcsnTable, echo = FALSE, eval = TRUE}
tab <- recode_fcs_nutrition(df = hh) %>%
  create_unweighted_table(vars = c("vita1", "vita2", "vita3",
                                   "protein1", "protein2", "protein3",
                                   "iron1", "iron2", "iron3"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100
```

Household consumption of vitamin A-, protein- and heme iron-rich foods indicate the quality of the household diet. In Kayin State, frequency of consumption of these nutrient-rich foods is generally high with vitamin A- and protein-rich foods consumed more frequently than heme iron-rich foods. In addition, frequency of household consumption of these nutrients is influenced by geographic location and wealth. Vitamin A-rich foods are consumed at least daily by `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Urban", "vita3"], digits = 1), "%", sep = "")` and `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Rural", "vita3"], digits = 1), "%", sep = "")` of households in urban and rural areas respectively and then drops to as low as `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Hard-to-reach", "vita3"], digits = 1), "%", sep = "")` in hard-to-reach areas (see Figure \@ref(fig:fcsn1plot)). The same decreasing pattern of frequency of vitamin A-rich foods consumption is noted when households are grouped by wealth quintiles with majority of the wealthiest and the wealthy consuming vitamin A-rich foods at least daily while poor and poorest households consumed vitamin A-rich foods at least daily only `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Poor", "vita3"], digits = 1), "%", sep = "")` and `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Poorest", "vita3"], digits = 1), "%", sep = "")` of the times respectively (see Figure \@ref(fig:fcsn2plot)). This same trend is noted with frequency of household consumption of protein-rich foods (see Figure \@ref(fig:fcsn3plot) and Figure \@ref(fig:fcsn4plot)) and frequency of household consumption of heme iron-rich foods (see Figure \@ref(fig:fcsn5plot) and \@ref(fig:fcsn6plot)) but to a lesser magnitude.

```{r fcsn1table, echo = FALSE, eval = TRUE}
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Food consumption score - nutrition",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", 
                                     "",
                                     "Never\n(\\%)", 
                                     "Sometimes\n(\\%)", 
                                     "At\nleast\ndaily\n(\\%)",
                                     "Never\n(\\%)", 
                                     "Sometimes\n(\\%)", 
                                     "At\nleast\ndaily\n(\\%)",
                                     "Never\n(\\%)", 
                                     "Sometimes\n(\\%)", 
                                     "At\nleast\ndaily\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 2, 
                                          "Vitamin A-rich foods" = 3, 
                                          "Protein-rich foods" = 3, 
                                          "Heme iron-rich foods" = 3)) %>% 
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

```{r fcsn1plot, echo = FALSE, eval = TRUE, fig.cap = "Vitamin A food consumption score classification by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = vita1:vita3,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, 
                             levels = c("vita3", "vita2", "vita1"),
                             labels = c("At least daily", "Sometimes", "Never"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS vitamin A classification") +
  themeSettings
```

```{r fcsn2plot, echo = FALSE, eval = TRUE, fig.cap = "Vitamin A food consumption score classification by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS vitamin A classification") +
  themeSettings
```

```{r fcsn3plot, echo = FALSE, eval = TRUE, fig.cap = "Protein food consumption score classification by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = protein1:protein3,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, 
                             levels = c("protein3", "protein2", "protein1"),
                             labels = c("At least daily", "Sometimes", "Never"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS protein classification") +
  themeSettings
```

```{r fcsn4plot, echo = FALSE, eval = TRUE, fig.cap = "Protein food consumption score classification by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS protein classification") +
  themeSettings
```

```{r fcsn5plot, echo = FALSE, eval = TRUE, fig.cap = "Heme iron-rich food consumption score classification by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = iron1:iron3,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, 
                             levels = c("iron3", "iron2", "iron1"),
                             labels = c("At least daily", "Sometimes", "Never"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS heme iron classification") +
  themeSettings
```

```{r fcsn6plot, echo = FALSE, eval = TRUE, fig.cap = "Protein food consumption score classification by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 3, name = "RdYlGn"))) +
  labs(x = "", y = "%", fill = "FCS heme iron classification") +
  themeSettings
```

### Coping strategies index {#csi-results}

#### Consumption-based coping strategies index {#ccsi-results}

```{r ccsi1table, echo = FALSE, eval = TRUE}
tab <- recode_csi_consumption(df = hh) %>%
  create_unweighted_table(vars = "bTotalWeighted")

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Consumption-based Coping Strategies Index",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = c("", "", "Mean CSI"),
             escape = TRUE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

Households in Kayin state are employing very few consumption-based coping strategies (see Table \@ref(tab:ccsi1table)). Use of consumption-based coping strategies is higher in households in hard-to-reach areas (`r round(tab[tab$state == "Kayin" & tab$strata == "Hard-to-reach", "bTotalWeighted"], digits = 1)`) compared to households in urban and rural areas (`r round(tab[tab$state == "Kayin" & tab$strata == "Urban", "bTotalWeighted"], digits = 1)` and `r round(tab[tab$state == "Kayin" & tab$strata == "Rural", "bTotalWeighted"], digits = 1)` respectively) as shown in Figure \@ref(fig:ccsi1plot) and Figure \@ref(fig:ccsi2plot).

\newpage

```{r ccsi1plot, echo = FALSE, eval = TRUE, fig.cap = "Consumption-based coping strategies index by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tab$strata <- factor(tab$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tab$state <- factor(tab$state, labels = c("Kayin", "Kayah"))

ggplot(data = tab[tab$strata %in% c("Urban", "Rural", "Hard-to-reach") & tab$state == "Kayin", ], 
       mapping = aes(x = strata, y = bTotalWeighted)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = round(bTotalWeighted, digits = 1)), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "Mean consumption-based CSI") +
  themeSettings
```

```{r ccsi2plot, echo = FALSE, eval = TRUE, fig.cap = "Consumption-based coping strategies index by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tab[!tab$strata %in% c("Urban", "Rural", "Hard-to-reach") & tab$state == "Kayin", ], 
       mapping = aes(x = strata, y = bTotalWeighted)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = round(bTotalWeighted, digits = 1)), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "Mean consumption-based CSI") +
  themeSettings
```

#### Livelihood-based coping strategies index {#lcsi-results}

The use of a few consumption-based coping strategies by households in Kayin state can be partly explained by close to 50% of households being relatively food secure in that they are not requiring longer-term livelihoods-based coping strategies. However, up to 40% of households across Kayin state utilise stress type of livelihoods coping strategies in the longer term (see Table \@ref(tab:lcsi1Table)). There is a seeming geographical and wealth gradient for livelihoods-based coping strategies. A higher proportion of households in hard-to-reach areas are relatively food secure and a lower proportion of households in hard-to-reach areas are in stress (see Figure \@ref(fig:lcsi1plot)). A similar trend can be found across wealth classes in that higher proportion of food secure households and lower proportion of households in stress or in crisis were observed among poorer households compared to wealthier households (see Figure \@ref(fig:lcsi2plot)).

```{r lcsi1table, echo = FALSE, eval = TRUE}
tab <- recode_csi_livelihoods(df = hh) %>%
  create_unweighted_table(vars = c("secure", "stress", "crisis", "emergency"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Livelihoods-based coping strategies index",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", c("Secure\n(\\%)", "Stress\n(\\%)", "Crisis\n(\\%)", "Emergency\n(\\%)")),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

```{r lcsi1plot, echo = FALSE, eval = TRUE, fig.cap = "Livelihoods-based coping strategies index by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = secure:emergency,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, levels = c("secure", "stress", "crisis", "emergency"))
tabLong$indicators <- factor(tabLong$indicators, labels = c("Secure", "Stress", "Crisis", "Emergency"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

```{r lcsi2plot, echo = FALSE, eval = TRUE, fig.cap = "Livelihoods-based coping strategies index by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

### Household food expenditure share {#hfes-results}

Majority of households accress Kayin state have low food insecurity (see Table \@ref(tab:hfes2table)) based on household food expenditure share (HFES). However, there are pockets of households in mostly hard-to-reach areas and households who are poor and poorest that are highly food insecure or vulnerable (see Figure \@ref(fig:hfesScatterPlot1) and Figure \@ref(fig:hfesScatterPlot2)).

```{r hfes2table, echo = FALSE, eval = TRUE}
tab <- recode_hfes(df = hh) %>%
  create_unweighted_table(vars = c("vulnerable", "high", "medium", "low"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Household food expenditure share",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", c("Vulnerable\n(\\%)", "High\n(\\%)", "Medium\n(\\%)", "Low\n(\\%)")),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::add_header_above(header = c(" " = 2, "Food Insecurity by HFES" = 4), align = "c") %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

```{r hfesScatterPlot1, echo = FALSE, eval = TRUE, fig.cap = "Household food expenditure share by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tab <- recode_hfes(df = hh)

tab <- tab[!is.na(tab$hfes), ]

tab$geo_state <- factor(x = tab$geo_state, 
                        levels = c("MMR002", "MMR003"),
                        labels = c("Kayah", "Kayin"))
tab$geo_rural <- factor(x = tab$geo_rural,
                        levels = c(1, 0, 2),
                        labels = c("Urban", "Rural", "Hard-to-reach"))

tab$hfesClass <- cut(x = tab$hfes, 
                     breaks = c(0, 0.5, 0.65, 0.75, 1),
                     labels = FALSE)

tab$hfesColour <- rev(brewer.pal(n = 4, name = "RdYlGn"))[tab$hfesClass]
tab$hfesColour <- factor(x = tab$hfesColour, 
                         levels = rev(brewer.pal(n = 4, name = "RdYlGn")))

hfesLabels <- c("Low", "Medium", "High", "Vulnerable")[tab$hfesClass]
hfesLabels <- factor(x = hfesLabels, 
                     levels = c("Low", "Medium", "High", "Vulnerable"))

ggplot(data = tab[tab$sample_component == 1 & tab$geo_state == "Kayin", ], 
       mapping = aes(x = food / 1000, y = hfes * 100, 
                     colour = hfesColour, 
                     size = hfesClass * 4)) +
  geom_point(pch = 20, alpha = 0.7) +
  scale_colour_identity(guide = "legend", 
                        breaks = levels(tab$hfesColour), 
                        labels = levels(hfesLabels)) +
  scale_size_identity() +
  facet_grid(. ~ geo_rural) + 
  scale_x_continuous(breaks = seq(from = 0, to = 300, by = 50)) +
  scale_y_continuous(breaks = seq(from = 0, to = 100, by = 20)) +
  labs(x = "Food expenditure (1,000 MMK)", y = "HFES (%)", fill = "HFES Classification") +
  themeSettings
```

```{r hfesScatterPlot2, echo = FALSE, eval = TRUE, fig.cap = "Household food expenditure share by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tab <- recode_hfes(df = hh)
ppi <- recode_ppi(df = hh)
ppi <- ppi[ , c("KEY", "ppi")]

tab <- merge(tab, ppi, by = "KEY")
tab <- tab[!is.na(tab$hfes), ]

tab$wealthQuintile <- NA

tab[tab$geo_state == "MMR002", "wealthQuintile"] <- cut(x = tab[tab$geo_state == "MMR002", "ppi"],
                                                        breaks = quantile(x = tab[tab$geo_state == "MMR002", "ppi"],
                                                                           probs = c(0, 0.2, 0.4, 0.6, 0.8, 1),
                                                                          na.rm = TRUE),
                                                        labels = FALSE)

tab[tab$geo_state == "MMR003", "wealthQuintile"] <- cut(x = tab[tab$geo_state == "MMR003", "ppi"],
                                                        breaks = quantile(x = tab[tab$geo_state == "MMR003", "ppi"],
                                                                          probs = c(0, 0.2, 0.4, 0.6, 0.8, 1),
                                                                          na.rm = TRUE),
                                                        labels = FALSE)

tab$wealthQuintile <- factor(x = tab$wealthQuintile, 
                             labels = c("Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

tab <- tab[!is.na(tab$wealthQuintile), ]

tab$geo_state <- factor(x = tab$geo_state, 
                        levels = c("MMR002", "MMR003"),
                        labels = c("Kayah", "Kayin"))
tab$geo_rural <- factor(x = tab$geo_rural,
                        levels = c(1, 0, 2),
                        labels = c("Urban", "Rural", "Hard-to-reach"))

tab$hfesClass <- cut(x = tab$hfes, 
                     breaks = c(0, 0.5, 0.65, 0.75, 1),
                     labels = FALSE)

tab$hfesColour <- rev(brewer.pal(n = 4, name = "RdYlGn"))[tab$hfesClass]
tab$hfesColour <- factor(x = tab$hfesColour, 
                         levels = rev(brewer.pal(n = 4, name = "RdYlGn")))

hfesLabels <- c("Low", "Medium", "High", "Vulnerable")[tab$hfesClass]
hfesLabels <- factor(x = hfesLabels, 
                     levels = c("Low", "Medium", "High", "Vulnerable"))

ggplot(data = tab[tab$sample_component == 1 & tab$geo_state == "Kayin", ], 
       mapping = aes(x = food / 1000, y = hfes * 100, 
                     colour = hfesColour, 
                     size = hfesClass * 4)) +
  geom_point(pch = 20, alpha = 0.7) +
  scale_colour_identity(guide = "legend", 
                        breaks = levels(tab$hfesColour), 
                        labels = levels(hfesLabels)) +
  scale_size_identity() +
  facet_grid(. ~ wealthQuintile) + 
  scale_x_continuous(breaks = seq(from = 0, to = 300, by = 50)) +
  scale_y_continuous(breaks = seq(from = 0, to = 100, by = 20)) +
  labs(x = "Food expenditure (1,000 MMK)", y = "HFES (%)", fill = "HFES Classification") +
  themeSettings
```

### Water, sanitation and hygiene {#wash-results}

#### Water services ladder {#water-results}

There is minimal seasonal variation in households' access to drinking water with majority of households able to get water from improved sources of drinking water whole year round (see \@ref(tab:wash1table)). However, up to 18% of households in hard-to-reach areas use surface water as their drinking water source (see Figure \@ref(fig:wash1plot)). Interestingly, in urban areas, up to 4% still access driking water from surface water. Figure \@ref(fig:wash2plot) show that the poorer the houshold gets, the higher the probability that the household is accessing drinking water from surface water.

```{r wash1table, echo = FALSE, eval = TRUE}
tab <- recode_wash(df = hh) %>%
  create_unweighted_table(vars = c("summer1", "summer6", "summer5",
                                   "rain1", "rain6", "rain5",
                                   "winter1", "winter6", "winter5"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

tab$strata <- factor(x = tab$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Water service ladders",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", rep(c("At least\nlimited\n(\\%)", "Unimproved\n(\\%)", "Surface\nwater\n(\\%)"), 3)),
                                   align = "c"),
             digits = 1,
             escape = FALSE,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 8) %>%
  kableExtra::add_header_above(header = c(" " = 2, 
                                          "Summer Season" = 3, 
                                          "Rainy Season" = 3, 
                                          "Winter Season" = 3),
                               bold = TRUE, align = "c") %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape
```

\newpage

```{r wash1plot, echo = FALSE, eval = TRUE, fig.cap = "Water services ladder by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = summer1:winter5,
                               names_to = "indicators", values_to = "estimate")

tabLong$season <- ifelse(stringr::str_detect(string = tabLong$indicators, pattern = "summer"), "Summer",
                    ifelse(stringr::str_detect(string = tabLong$indicators, pattern = "rain"), "Rainy", "Winter"))

tabLong$indicators <- factor(tabLong$indicators, labels = rep(c("At least limited", "Unimproved", "Surface water"), 3))
tabLong$strata <- factor(tabLong$strata, levels = c("Rural", "Urban", "Hard-to-reach", paste("Wealth Quintile ", 1:5, sep = "")))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = season, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = waterLadder[1:3]) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

```{r wash2plot, echo = FALSE, eval = TRUE, fig.cap = "Water services ladder by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = summer1:winter5,
                               names_to = "indicators", values_to = "estimate")

tabLong$season <- ifelse(stringr::str_detect(string = tabLong$indicators, pattern = "summer"), "Summer",
                    ifelse(stringr::str_detect(string = tabLong$indicators, pattern = "rain"), "Rainy", "Winter"))

tabLong$indicators <- factor(tabLong$indicators, labels = rep(c("At least limited", "Unimproved", "Surface water"), 3))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = season, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = waterLadder[1:3]) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Sanitation services ladder

```{r sanTable, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_wash(df = hh) %>%
  create_unweighted_table(vars = c("san3", "san4", "san5", "san6"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100
```

Up to 78% of households in urban areas of Kayin state have at least limited (improved toilet facility but shared with other households) or basic (improved sanitation facility and not shared with other households) sanitation facilities (see Table \@ref(tab:san1table)). On the other hand, unimproved sanitation facilities and open defection are used by more households in hard-to-reach areas (see \@ref(fig:san1plot)) and increasingly used as households get poorer (see Figure \@ref(fig:san2plot)). Up to `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Wealthiest", "san5"], digits = 1), "%", sep = "")` of wealthiest households and `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Wealthy", "san5"], digits = 1), "%", sep = "")` of wealthy households have unimproved sanitation facialities.

```{r san1table, echo = FALSE, eval = TRUE}
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Sanitation service ladders",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", c("Basic\n(\\%)", "Limited\n(\\%)", "Unimproved\n(\\%)", "Open\nDefecation\n(\\%)")),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

```{r san1plot, echo = FALSE, eval = TRUE, fig.cap = "Sanitation services ladder by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = san3:san6,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, labels = c("Basic", "Limited", "Unimproved", "Open defecation"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = sanitationLadder[1:4]) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

```{r san2plot, echo = FALSE, eval = TRUE, fig.cap = "Water services ladder by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = sanitationLadder[1:4]) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Handwashing service ladder

```{r handwashingTable, echo = FALSE, eval = TRUE}
tab <- recode_wash(df = hh) %>%
  create_unweighted_table(vars = c("hw14", "hw15", "hw16"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100
```

Access to basic (handwashing facilities with water and soap) handwashing facilities is as high as `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Urban", "hw14"], digits = 1), "%", sep = "")` in urban areas and `r paste(round(tab[tab$state == "Kayin" & tab$strata == "Rural", "hw14"], digits = 1), "%", sep = "")` in rural areas. Hard-to-reach areas on the other hand have much lower access to basic facilities and with the highest proportion of households with no facilities at all (see Figure \@ref(fig:handwashing1plot)). The same trend exists as households get poorer with the poorest households having low levels of access to basic handwashing facilities and highest levels of no handwashing facilities (see Figure \@ref(fig:handwashing2plot)).

```{r handwashing1table, echo = FALSE, eval = TRUE}
tab <- recode_wash(df = hh) %>%
  create_unweighted_table(vars = c("hw14", "hw15", "hw16"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Handwashing service ladders",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", "Basic\n(\\%)", "Limited\n(\\%)", "No\nFacility\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

```{r handwashing1plot, echo = FALSE, eval = TRUE, fig.cap = "Handwashing services ladder by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = hw14:hw16,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, labels = c("Basic", "Limited", "No facility"))
tabLong$strata <- factor(tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = handwashLadder) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

```{r handwashing2plot, echo = FALSE, eval = TRUE, fig.cap = "Handwashing services ladder by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(. ~ state) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = handwashLadder) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

### Child health {#chealth-results}

#### Immunisation coverage {#epi-results}

Immunisation coverage in Kayin state tells a story of a generally wide exposure to immunisation services with nearly all children having had any immunisation in urban and rural areas and up to 86% in hard-to-reach areas then falters early and dramatically with immunisation access as proxied by BCG vaccination drastically dropping to only as high as 22% in urban and rural areas and 15% in hard-to-reach areas. This drop in immunisation coverage continues with utilisation of immunisation services (as proxied by children getting all required pentavalent vaccinations) further drops particularly in hard-to-reach areas and then full immunisation coverage drops significantly in all areas but more profoundly in hard-to-reach areas (see Figure \@ref(fig:epi1plot)).

Per vaccination type coverage, as to be expected, is significantly low across the whole of Kayin state (see Table \@ref(tab:epi2table)) with households in hard-to-reach areas and poor and poorest households with significantly lower per vaccine type coverage, except for BCG, compared to urban and rural areas and wealthy and wealthiest households (see Figure \@ref(fig:epi3plot) and Figure \@ref(fig:epi4plot)).

Coverage of vitamin A supplementation, a service that is usually delivered together with immunisation, is relatively higher going up to about 60% in rural areas but much lower in urban and hard-to-reach areas (see Figure \@ref(fig:epi5plot)) and lower in wealthiest and poorest households (see Figure \@ref(fig:epi6plot)). Deworming coverage is low at only up to 25% in rural areas and considerably lower in urban and hard-to-reach areas (see Figure \@ref(fig:epi5plot)). Interestingly, poorest households have relatively higher deworming rates among wealth classes (see Figure \@ref(fig:epi6plot)).

```{r epi1table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("vac1", "vac2", "vac3", "vac4", "vac5", "vac6"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Immunisation coverage",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Ever\nvaccinated\n(\\%)", 
                                     "Vaccination\ncard\nretention\nrate\n(\\%)", 
                                     "Immunisation\naccess\n(\\%)", 
                                     "Immunisation\nutilisation\n(\\%)",
                                     "Full\nimmunisation\ncoverage\n(\\%)",
                                     "Hepatitis B\nimmunisation\ngiven\nwithin\nfirst\n24\nhours\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 8) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

\newpage

```{r epi1plot, echo = FALSE, eval = TRUE, fig.cap = "Immunisation coverage by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tab <- subset(tab, select = c(-vac2, -vac6))

tabLong <- tidyr::pivot_longer(data = tab,
                               cols = c("vac1", "vac3", "vac4", "vac5"),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators, 
                             labels = c("Ever\nimmunised", 
                                        "Immunisation\naccess", 
                                        "Immunisation\nutilisation", 
                                        "Full\nimmunisation"))
tabLong$strata <- factor(tabLong$strata, 
                         levels = c("Urban", "Rural", "Hard-to-reach", 
                                    "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  facet_grid(. ~ indicators) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r epi2plot, echo = FALSE, eval = TRUE, fig.cap = "Immunisation coverage by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  facet_grid(. ~ indicators) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r epi2table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("bcg", "hepb", "penta1", "penta2", "penta3", 
                                   "polio1", "polio2", "polio3", "polioinj", 
                                   "measles1", "measles2", "rubella", "enc"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Immunisation coverage per vaccine type",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "BCG\n(\\%)", 
                                     "Hepatitis B\n(\\%)", 
                                     "Penta 1\n(\\%)",
                                     "Penta 2\n(\\%)",
                                     "Penta 3\n(\\%)",
                                     "OPV 1\n(\\%)",
                                     "OPV 2\n(\\%)",
                                     "OPV 3\n(\\%)",
                                     "IPV\n(\\%)",
                                     "Measles 1\n(\\%)",
                                     "Measles 2\n(\\%)",
                                     "Rubella\n(\\%)",
                                     "Pneumococcal\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r epi3plot, echo = FALSE, eval = TRUE, fig.cap = "Immunisation coverage per vaccine by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = c("bcg", "hepb", "penta1", "penta2", 
                                        "penta3", "polio1", "polio2", "polio3", 
                                        "polioinj", "measles1", "measles2", 
                                        "rubella", "enc"),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators,
                             levels = c("bcg", "hepb", "penta1", "penta2", 
                                        "penta3", "polio1", "polio2", "polio3", 
                                        "polioinj", "measles1", "measles2", 
                                        "rubella", "enc"),
                             labels = c("BCG", 
                                        "Hepatitis B", 
                                        "Penta 1",
                                        "Penta 2",
                                        "Penta 3",
                                        "OPV 1",
                                        "OPV 2",
                                        "OPV 3",
                                        "IPV",
                                        "Measles 1",
                                        "Measles 2",
                                        "Rubella",
                                        "Pneumo"))
tabLong$strata <- factor(tabLong$strata, 
                         levels = c("Urban", "Rural", "Hard-to-reach", 
                                    "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r epi4plot, echo = FALSE, eval = TRUE, fig.cap = "Immunisation coverage per vaccine by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

Age-appropriate immunisation coverage per vaccine and overall (see Table \@ref(tab:epi1aTable), Figure \@ref(fig:epi3aPlot) and \@ref(fig:epi4aPlot)) show similar rates and trends across location types and wealth classes as the standard immunisation coverage indicators. This would indicate that the low levels of immunisaiton is a long-standing issue rather than just a current phenomenon.

```{r epi1aTable, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("ageBCG", "ageHepB", "agePenta1", "agePenta2", "agePenta3", 
                                   "agePolio1", "agePolio2", "agePolio3", "agePolioInj", 
                                   "ageMeasles1", "ageMeasles2", "ageRubella", "ageImm"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Age-appropriate immunisation coverage",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "BCG\n(\\%)", 
                                     "Hepatitis B\n(\\%)",
                                     "Penta 1\n(\\%)",
                                     "Penta 2\n(\\%)",
                                     "Penta 3\n(\\%)",
                                     "Polio 1\n(\\%)",
                                     "Polio 2\n(\\%)",
                                     "Polio 3\n(\\%)",
                                     "IPV\n(\\%)",
                                     "Measles 1\n(\\%)",
                                     "Measles 2\n(\\%)",
                                     "Rubella\n(\\%)",
                                     "Age-\nappropriate\nimmunisation\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r epi3aPlot, echo = FALSE, eval = TRUE, fig.cap = "Age-appropriate immunisation coverage per vaccine by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = c("ageBCG", "ageHepB", 
                                        "agePenta1", "agePenta2", "agePenta3", 
                                        "agePolio1", "agePolio2", "agePolio3", "agePolioInj", 
                                        "ageMeasles1", "ageMeasles2", "ageRubella", 
                                        "ageImm"),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators,
                             levels = c("ageBCG", "ageHepB", 
                                        "agePenta1", "agePenta2", "agePenta3", 
                                        "agePolio1", "agePolio2", "agePolio3", "agePolioInj", 
                                        "ageMeasles1", "ageMeasles2", "ageRubella", 
                                        "ageImm"),
                             labels = c("BCG", 
                                        "Hepatitis B", 
                                        "Penta 1",
                                        "Penta 2",
                                        "Penta 3",
                                        "OPV 1",
                                        "OPV 2",
                                        "OPV 3",
                                        "IPV",
                                        "Measles 1",
                                        "Measles 2",
                                        "Rubella",
                                        "Age-appropriate immunisation"))
tabLong$strata <- factor(tabLong$strata, 
                         levels = c("Urban", "Rural", "Hard-to-reach", 
                                    "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r epi4aPlot, echo = FALSE, eval = TRUE, fig.cap = "Age-appropriate immunisation coverage per vaccine by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r epi3table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("vita", "worm"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Coverage of immunisation-associated services",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Vitamin\nA\nsupplementation\n(\\%)", 
                                     "Deworming\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

```{r epi5plot, echo = FALSE, eval = TRUE, fig.cap = "Immunisation-associated services coverage by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab,
                               cols = vita:worm,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(tabLong$indicators,
                             levels = c("vita", "worm"),
                             labels = c("Vitamin A supplementation", "Deworming"))
tabLong$strata <- factor(tabLong$strata, 
                         levels = c("Urban", "Rural", "Hard-to-reach", 
                                    "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))
tabLong$state <- factor(tabLong$state, levels = c("Kayin", "Kayah"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r epi6plot, echo = FALSE, eval = TRUE, fig.cap = "Immunisation-associated services coverage by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

#### Period prevalence of childhood illnesses {#illness}

Fever is the most self-reported illness in children 6-59 months old with up to 29% of mothers reporting fever in their children in the past 2 weeks in rural areas followed closely by those in urban areas at 26% and by 18% of mothers in hard-to-reach areas (see Figure \@ref(fig:ill1plot)). The wealtheir households also report fever the most at 27% compared to 19% for poor and 21% for poorest households (see Figure \@ref(fig:ill2plot)).

ARI is the next most self-reported illness in children 6-59 months old with up to 11% of mothers in hard-to-reach areas reporting ARI in their children in the past 2 weeks (see Figure \@ref(fig:ill1plot). No clear trend by wealth classes can be observed with self-reporting of ARI (see Figure \@ref(fig:ill2plot)).

Diarrhoea is the least self-reported illness in children 6-59 months old with 2% of mothers in urban areas reporting cough in their children in the past 2 weeks. Those in rural and hard-to-reach areas report diarrhoea the most at 3% (see Figure \@ref(fig:ill1plot). The poorest households reported the most diarrhoea in children at 5% (see Figure \@ref(fig:ill2plot)).

```{r ill1table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("dia1", "ari1", "fev1"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Period prevalence of childhood illnesses",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", c("Diarrhoea\n(\\%)", "ARI\n(\\%)", "Fever\n(\\%)")),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

```{r ill1plot, echo = FALSE, eval = TRUE, fig.cap = "Period prevalence of childhood illnesses by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = dia1:fev1,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, labels = c("Diarrhoea", "ARI", "Fever"))
tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r ill2plot, echo = FALSE, eval = TRUE, fig.cap = "Period prevalence of childhood illnesses by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  labs(x = "", y = "%") +
  themeSettings
```

#### Treatment-seeking behaviour {#ctreatment}

##### Diarrhoea {#diarrhoea}

Treatment-seeking for diarrhoea in Kayin state can be characterised by households in urban areas seeking treatment the most (88%) followed closely by those in hard-to-reach areas at 80%. Those in urban areas are seeking treatment slightly less (see Figure \@ref(fig:diarrhoea1plot)). Most households across the wealth classifications seek treatment for diarrhoea except for the poorest households who seek treatment for diarrhoea the least at 55% and the wealthiest at 80% (see Figure \@ref(fig:diarrhoea2plot)). When asked why treatment was not sought for diarrhoea, those from the urban areas felt that treatment wasn't necessary and that cost was also a consideration whilst those in rural areas reported seeking alternative treatment and that health facility was inaccessible (see Figure \@ref(fig:diarrhoea3plot)). Cost was the main reason for not seeking treatment from those in hard-to-reach areas. Time to treatment was short (1 day on average) and the same across areas (see Table \@ref(tab:diarrhoea1table)).

Those from urban areas tended to see a private doctor whilst those from rural areas sought care from the RHC or the SRHC. Those from hard-to-reach areas tended to self-medicate or get care from an EHO clinic (see Figure \@ref(fig:diarrhoea5plot)). Most of the wealthiest households sought treatment from a private clinic/doctor whilst the poor and the poorest households sought care from either the station hospital, ethnic health worker, community health worker or self-medicated with drugs from the shop (see Figure \@ref(fig:diarrhoea6plot))

Costs incurred for treatment were mostly for medications (see Table \@ref(tab:diarrhoea3table)).

```{r diarrhoea1table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("dia2", "dia4", "dia3a", "dia3b", "dia3c", "dia3d", 
                                   "dia3f", "dia3g", "dia3h"))

tab[ , c(3, 5:ncol(tab))] <- tab[ , c(3, 5:ncol(tab))] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Treatment-seeking for diarrhoea",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Sought\ntreatment\n(\\%)",
                                     "Time to\ntreatment\n(days)",
                                     "No\nfacility\n(\\%)", 
                                     "Facility\ninaccessible\n(\\%)",
                                     "Expensive\n(\\%)", 
                                     "Not\nnecessary\n(\\%)", 
                                     "Advised\nnot to\n(\\%)", 
                                     "Alternative\ntreatment\n(\\%)",
                                     "Do not know\ntreamtent\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Reasons for not seeking treatment" = 7),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r diarrhoea1plot, echo = FALSE, eval = TRUE, fig.cap = "Treatment-seeking for diarrhoea by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = dia2:dia3h,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("dia2", "dia4", "dia3a", "dia3b", 
                                        "dia3c", "dia3d", "dia3f", "dia3g", "dia3h"),
                             labels = c("Sought treatment", 
                                        "Time to treatment", "No facility", 
                                        "Facility inaccessible", "Expensive", 
                                        "Not necessary", "Advised not to", 
                                        "Alternative treatment", "Do not know treatment"))
tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$indicators == "Sought treatment" & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r diarrhoea2plot, echo = FALSE, eval = TRUE, fig.cap = "Treatment-seeking for diarrhoea by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$indicators == "Sought treatment" & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r diarrhoea3plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for not seeking treatment by location type", fig.width = 14, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$state == "Kayin" & 
                        tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & 
                        !tabLong$indicators %in% c("Sought treatment", "Time to treatment"), ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata), 
                     y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r diarrhoea4plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for not seeking treatment by wealth quintiles", fig.width = 14, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$state == "Kayin" & 
                        !tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & 
                        !tabLong$indicators %in% c("Sought treatment", "Time to treatment"), ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata), 
                     y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r diarrhoea2table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("dia5a", "dia5b", "dia5c", "dia5d", "dia5e",
                                   "dia5f", "dia5g", "dia5h", "dia5i", "dia5j",
                                   "dia5k", "dia5l", "dia5m"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Where/who treatment is sought from",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Township\nhospital\n(\\%)",
                                     "Station\nhospital\n(\\%)",
                                     "RHC/\nhealth\nassistant\n(\\%)", 
                                     "SRHC/\nmidwife\n(\\%)",
                                     "Private\nclinic/\ndoctor\n(\\%)", 
                                     "Community\nhealth\nworker\n(\\%)", 
                                     "Traditional\nhealer\n(\\%)", 
                                     "Untrained\nhealth\nworker\n(\\%)",
                                     "Drug\nfrom\nshop\n(\\%)",
                                     "EHO\nclinic/\nvolunteer\n(\\%)",
                                     "Family\nmember\n(\\%)",
                                     "NGOs/\nclinic\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 2, "Where/who treatment is sought from" = 13),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r diarrhoea5plot, echo = FALSE, eval = TRUE, fig.cap = "Where/who treatment is sought from by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = dia5a:dia5m,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("dia5a", "dia5b", "dia5c", "dia5d", 
                                        "dia5e", "dia5f", "dia5g", "dia5h", 
                                        "dia5i", "dia5j", "dia5k", "dia5l", 
                                        "dia5m"),
                             labels = c("Township hospital",
                                        "Station hospital",
                                        "RHC/health assistant", 
                                        "SRHC/midwife",
                                        "Private clinic/doctor", 
                                        "Community health worker", 
                                        "Traditional healer", 
                                        "Untrained health worker",
                                        "Drug from shop",
                                        "EHO clinic/volunteer",
                                        "Family member",
                                        "NGOs/clinic",
                                        "Auxilliary midwife"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r diarrhoea6plot, echo = FALSE, eval = TRUE, fig.cap = "Where/who treatment is sought from by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

```{r diarrhoea3table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("dia7", "dia8a", "dia8b", "dia8c", "dia8d",
                                   "dia8e", "dia8f", "dia9"))

tab[ , 4:ncol(tab)] <- tab[ , 4:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Payment for treatment",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Payment\nfor\nservice\n(MMK)",
                                     "Transportation\n(\\%)",
                                     "Registration\n(\\%)",
                                     "Medicine\n(\\%)", 
                                     "Laboratory\nfees\n(\\%)",
                                     "Provider\nfees\n(\\%)", 
                                     "Gifts\n(\\%)",
                                     "Took\nloan\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 3, "Payment for" = 6, " "),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r diarrhoea7plot, echo = FALSE, eval = TRUE, fig.cap = "Costs incurred for treatment by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = dia8a:dia8f,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Transportation",
                                        "Registration",
                                        "Medicine", 
                                        "Laboratory fees",
                                        "Provider fees", 
                                        "Gifts"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r diarrhoea8plot, echo = FALSE, eval = TRUE, fig.cap = "Costs incurred for treatment by wealth quintile", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = dia8a:dia8f,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Transportation",
                                        "Registration",
                                        "Medicine", 
                                        "Laboratory fees",
                                        "Provider fees", 
                                        "Gifts"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

##### Acute respiratory infection {#ari}

Treatment-seeking for ARI in Kayin state can be characterised by households in rural areas seeking treatment the most (89.2%) followed closely by those from urban areas at 85% whilst those in hard-to-reach areas seeking treatment less at 74% (see Figure \@ref(fig:ari1plot)). Most households in the wealthier classes and much lesser number of households from the poorer classes sought care for ARI (see Figure \@ref(fig:ari2plot)).

When asked why treatment was not sought for ARI, those from the urban areas didn't think it was necessary or found alternative treatment. Those from hard-to-reach areas, on the other hand, don't know treatment for ARI hence have not sough care (see Figure \@ref(fig:ari3plot)). Amongst the wealthier households, most think that treatment wasn't necessary or sought alternative treatment. Those in the poorer households, on the other hand, don't know of any treatment whilst also thinking that treatment wasn't necessary or seeking alternative treatment (see Figure \@ref(fig:ari4plot)).

Those from urban areas tended to see a private doctor whilst those from rural and hard-to-reach areas predominantly went to the EHO clinic or self-medicated (see Figure \@ref(fig:ari5plot)). The wealthier households sought treatement for ARI from a private clinic/doctor whilst the poorer households went to the ethnic health worker or self-medicated (see Figure \@ref(fig:ari6plot)).

Costs incurred for treatment were majority for medications (see Table \@ref(tab:ari3table)).

```{r ari1table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("ari2", "ari4", "ari3a", "ari3b", "ari3c", "ari3d", 
                                   "ari3f", "ari3g", "ari3h"))

tab[ , c(3, 5:ncol(tab))] <- tab[ , c(3, 5:ncol(tab))] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Treatment-seeking for acute respiratory infection",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Sought\ntreatment\n(\\%)",
                                     "Time to\ntreatment\n(days)",
                                     "No\nfacility\n(\\%)", 
                                     "Facility\ninaccessible\n(\\%)",
                                     "Expensive\n(\\%)", 
                                     "Not\nnecessary\n(\\%)", 
                                     "Advised\nnot to\n(\\%)", 
                                     "Alternative\ntreatment\n(\\%)",
                                     "Do not know\ntreamtent\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Reasons for not seeking treatment" = 7),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r ari1plot, echo = FALSE, eval = TRUE, fig.cap = "Treatment-seeking for acute respiratory infection by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = ari2:ari3h,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("ari2", "ari4", "ari3a", "ari3b", 
                                        "ari3c", "ari3d", "ari3f", "ari3g", 
                                        "ari3h"),
                             labels = c("Sought treatment", 
                                        "Time to treatment", "No facility", 
                                        "Facility inaccessible", "Expensive", 
                                        "Not necessary", "Advised not to", 
                                        "Alternative treatment", "Do not know treatment"))
tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$indicators == "Sought treatment" & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r ari2plot, echo = FALSE, eval = TRUE, fig.cap = "Treatment-seeking for acute respiratory infection by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$indicators == "Sought treatment" & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r ari3plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for not seeking treatment by location type", fig.width = 14, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$state == "Kayin" & 
                        tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & 
                        !tabLong$indicators %in% c("Sought treatment", "Time to treatment"), ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata), 
                     y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r ari4plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for not seeking treatment by wealth quintile", fig.width = 14, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$state == "Kayin" & 
                        !tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & 
                        !tabLong$indicators %in% c("Sought treatment", "Time to treatment"), ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata), 
                     y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r ari2table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("ari5a", "ari5b", "ari5c", "ari5d", "ari5e",
                                   "ari5f", "ari5g", "ari5h", "ari5i", "ari5j",
                                   "ari5k", "ari5l", "ari5m"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Where/who treatment is sought from",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Township\nhospital\n(\\%)",
                                     "Station\nhospital\n(\\%)",
                                     "RHC/\nhealth\nassistant\n(\\%)", 
                                     "SRHC/\nmidwife\n(\\%)",
                                     "Private\nclinic/\ndoctor\n(\\%)", 
                                     "Community\nhealth\nworker\n(\\%)", 
                                     "Traditional\nhealer\n(\\%)", 
                                     "Untrained\nhealth\nworker\n(\\%)",
                                     "Drug\nfrom\nshop\n(\\%)",
                                     "EHO\nclinic/\nvolunteer\n(\\%)",
                                     "Family\nmember\n(\\%)",
                                     "NGOs/\nclinic\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 2, "Where/who treatment is sought from" = 13),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r ari5plot, echo = FALSE, eval = TRUE, fig.cap = "Where/who treatment is sought from by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = ari5a:ari5m,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Township hospital",
                                        "Station hospital",
                                        "RHC/health assistant", 
                                        "SRHC/midwife",
                                        "Private clinic/doctor", 
                                        "Community health worker", 
                                        "Traditional healer", 
                                        "Untrained health worker",
                                        "Drug from shop",
                                        "EHO clinic/volunteer",
                                        "Family member",
                                        "NGOs/clinic",
                                        "Auxilliary midwife"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

```{r ari6plot, echo = FALSE, eval = TRUE, fig.cap = "Where/who treatment is sought from by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

```{r ari3table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("ari7", "ari8a", "ari8b", "ari8c", "ari8d",
                                   "ari8e", "ari8f", "ari9"))

tab[ , 4:ncol(tab)] <- tab[ , 4:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Payment for treatment",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Payment\nfor\nservice\n(MMK)",
                                     "Transportation\n(\\%)",
                                     "Registration\n(\\%)",
                                     "Medicine\n(\\%)", 
                                     "Laboratory\nfees\n(\\%)",
                                     "Provider\nfees\n(\\%)", 
                                     "Gifts\n(\\%)",
                                     "Took\nloan\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 3, "Payment for" = 6, " "),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r ari7plot, echo = FALSE, eval = TRUE, fig.cap = "Costs incurred for treatment by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = ari8a:ari8f,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Transportation",
                                        "Registration",
                                        "Medicine", 
                                        "Laboratory fees",
                                        "Provider fees", 
                                        "Gifts"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r ari8plot, echo = FALSE, eval = TRUE, fig.cap = "Costs incurred for treatment by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

##### Fever {#fever}

Treatment-seeking for fever in Kayin state can be characterised by households in urban and rural areas seeking treatment the most (91% and 94% respectively) whilst those in hard-to-reach areas seeking treatment slightly lesser (see Figure \@ref(fig:fever1plot)). Most of households across wealth classes sought treatment for fever with the poorest households seeking care the least at 80% (see Figure \@ref(fig:fever2plot)).

When asked why treatment was not sought for fever, those from the urban areas thought that treatment was not necessary or sought alternative treatment. Households in rural areas also sought alternative treatment. Hard-to-reach households, on the other hand, had issues accesing facilities and are not aware of treatment for fever (see Figure \@ref(fig:fever3plot)). Most households across wealth classes sought alternative treatment except for poorest households who thought treatment was not necessary and who found health facilities inaccessible or expensive (see Figure \@ref(fig:fever4plot)). Time to treatment is generally the same between households in different location types and across wealth classes at about 1 day to treatment (see Table \@ref(tab:fever1table)).

Those from urban and rural areas tended to see a private doctor, those from rural areas would often visit their SRHC and those from hard-to-reach areas predominantly went to their EHO clinic (see Figure \@ref(fig:fever5plot)). Wealthier households often sought treatment from private doctor and the poorest households visit the SRHC or self-medicate (see Figure \@ref(fig:fever6plot).

Costs incurred for treatment were majority for medications (see Table \@ref(tab:fever3table), Figure \@ref(fig:fever7plot) and Figure \@ref(fig:fever8plot)).

```{r fever1table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("fev2", "fev4", "fev3a", "fev3b", "fev3c", "fev3d", 
                                   "fev3f", "fev3g", "fev3h"))

tab[ , c(3, 5:ncol(tab))] <- tab[ , c(3, 5:ncol(tab))] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Treatment-seeking for fever",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Sought\ntreatment\n(\\%)",
                                     "Time to\ntreatment\n(days)",
                                     "No\nfacility\n(\\%)", 
                                     "Facility\ninaccessible\n(\\%)",
                                     "Expensive\n(\\%)", 
                                     "Not\nnecessary\n(\\%)", 
                                     "Advised\nnot to\n(\\%)", 
                                     "Alternative\ntreatment\n(\\%)",
                                     "Do not know\ntreamtent\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Reasons for not seeking treatment" = 7),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r fever1plot, echo = FALSE, eval = TRUE, fig.cap = "Treatment-seeking for fever by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = fev2:fev3h,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("fev2", "fev4", "fev3a", "fev3b", 
                                        "fev3c", "fev3d", "fev3f", "fev3g", 
                                        "fev3h"),
                             labels = c("Sought treatment", 
                                        "Time to treatment", "No facility", 
                                        "Facility inaccessible", "Expensive", 
                                        "Not necessary", "Advised not to", 
                                        "Alternative treatment", "Do not know treatment"))
tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$indicators == "Sought treatment" & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r fever2plot, echo = FALSE, eval = TRUE, fig.cap = "Treatment-seeking for fever by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$indicators == "Sought treatment" & tabLong$state == "Kayin", ],
       mapping = aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(. ~ state) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r fever3plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for not seeking treatment by location type", fig.width = 14, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$state == "Kayin" & 
                        tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & 
                        !tabLong$indicators %in% c("Sought treatment", "Time to treatment"), ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata), 
                     y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fever4plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for not seeking treatment by wealth quintiles", fig.width = 14, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$state == "Kayin" & 
                        !tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & 
                        !tabLong$indicators %in% c("Sought treatment", "Time to treatment"), ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata), 
                     y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fever2table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("fev5a", "fev5b", "fev5c", "fev5d", "fev5e",
                                   "fev5f", "fev5g", "fev5h", "fev5i", "fev5j",
                                   "fev5k", "fev5l", "fev5m"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Where/who treatment is sought from",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Township\nhospital\n(\\%)",
                                     "Station\nhospital\n(\\%)",
                                     "RHC/\nhealth\nassistant\n(\\%)", 
                                     "SRHC/\nmidwife\n(\\%)",
                                     "Private\nclinic/\ndoctor\n(\\%)", 
                                     "Community\nhealth\nworker\n(\\%)", 
                                     "Traditional\nhealer\n(\\%)", 
                                     "Untrained\nhealth\nworker\n(\\%)",
                                     "Drug\nfrom\nshop\n(\\%)",
                                     "EHO\nclinic/\nvolunteer\n(\\%)",
                                     "Family\nmember\n(\\%)",
                                     "NGOs/\nclinic\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 2, "Where/who treatment is sought from" = 13),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r fever5plot, echo = FALSE, eval = TRUE, fig.cap = "Where/who treatment is sought from by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = fev5a:fev5m,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("fev5a", "fev5b", "fev5c", "fev5d", 
                                        "fev5e", "fev5f", "fev5g", "fev5h", 
                                        "fev5i", "fev5j", "fev5k", "fev5l", 
                                        "fev5m"),
                             labels = c("Township hospital",
                                        "Station hospital",
                                        "RHC/health assistant", 
                                        "SRHC/midwife",
                                        "Private clinic/doctor", 
                                        "Community health worker", 
                                        "Traditional healer", 
                                        "Untrained health worker",
                                        "Drug from shop",
                                        "EHO clinic/volunteer",
                                        "Family member",
                                        "NGOs/clinic",
                                        "Auxilliary midwife"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")),
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fever6plot, echo = FALSE, eval = TRUE, fig.cap = "Where/who treatment is sought from by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")),
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

```{r fever3table, echo = FALSE, eval = TRUE}
tab <- recode_chealth(df = create_chealth(df = childHealth, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("fev7", "fev8a", "fev8b", "fev8c", "fev8d",
                                   "fev8e", "fev8f", "fev9"))

tab[ , 4:ncol(tab)] <- tab[ , 4:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Payment for treatment",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Payment\nfor\nservice\n(MMK)",
                                     "Transportation\n(\\%)",
                                     "Registration\n(\\%)",
                                     "Medicine\n(\\%)", 
                                     "Laboratory\nfees\n(\\%)",
                                     "Provider\nfees\n(\\%)", 
                                     "Gifts\n(\\%)",
                                     "Took\nloan\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 3, "Payment for" = 6, " "),
                               align = "c", bold = TRUE) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r fever7plot, echo = FALSE, eval = TRUE, fig.cap = "Costs incurred for treatment by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = fev8a:fev8f,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("fev8a", "fev8b", "fev8c", "fev8d",
                                        "fev8e", "fev8f"),
                             labels = c("Transportation",
                                        "Registration",
                                        "Medicine", 
                                        "Laboratory fees",
                                        "Provider fees", 
                                        "Gifts"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")),
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fever8plot, echo = FALSE, eval = TRUE, fig.cap = "Costs incurred for treatment by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")),
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

### Child nutrition {#cnutrition-results}

#### Prevalence of childhood stunting/stuntedness {#stunting}

```{r stunt1table, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_anthro(df = create_canthro(df = childAnthro, x = anthroDF)) %>%
  create_anthro_table(vars = c("haz", "global.haz", "moderate.haz", "severe.haz"))

tab[  , 4:ncol(tab)] <- tab[  , 4:ncol(tab)] * 100
```

Global childhood stunting/stuntedness in Kayin state goes as high as 40% in hard-to-reach areas and as low as 16% in urban areas. There is a geographical gradient in the childhood stunting/stuntedness indicator such that urban areas tend to have the lowest prevalence whilst the hard-to-reach areas had the highest. This trend is consistent for moderate stunting/stuntedness and severe stunting/stuntedness (see Table \@ref(tab:stunt2table) and Figure \@ref(fig:stuntPlot)).

```{r stunt2table, echo = FALSE, eval = TRUE}
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Child stunting/stuntedness",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Height-for-age\nz-score",
                                     "Global\nstunting/\nstuntedness\n(\\%)",
                                     "Moderate\nstutning/\nstuntedness\n(\\%)",
                                     "Severe\nstunting/\nstuntedness\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3),
                        italic = TRUE)
```

```{r stuntPlot, echo = FALSE, eval = TRUE, fig.cap = "Prevalence of childhood stunting/stuntedness", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = moderate.haz:severe.haz,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Moderate stunting/stuntedness", 
                                        "Severe stunting/stuntedness"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5, alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 5) +
  #facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = c("yellow", "red")) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Prevalence of childhood underweight {#underweight}

Global childhood stunting/stuntedness in Kayin state goes as high as 24% in hard-to-reach areas and as low as 13% in urban and rural areas. There is a geographical gradient in the childhood underweight indicator such that urban areas tend to have the lowest prevalence whilst the hard-to-reach areas had the highest. This trend is consistent for moderate underweight and severe underweight (see Table \@ref(tab:underweight2table) and Figure \@ref(fig:underweightPlot)).

```{r underweight1table, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_anthro(df = create_canthro(df = childAnthro, x = anthroDF)) %>%
  create_anthro_table(vars = c("waz", "global.waz", "moderate.waz", "severe.waz"))

tab[  , 4:ncol(tab)] <- tab[  , 4:ncol(tab)] * 100
```

```{r underweight2table, echo = FALSE, eval = TRUE}
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Child underweight",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Weight-for-age\nz-score",
                                     "Global\nunderweight\n(\\%)",
                                     "Moderate\nunderweight\n(\\%)",
                                     "Severe\nunderweight\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3),
                        italic = TRUE)
```

```{r underweightPlot, echo = FALSE, eval = TRUE, fig.cap = "Prevalence of childhood underweight", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = moderate.waz:severe.waz,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Moderate underweight", 
                                        "Severe underweight"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5, alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 5) +
  #facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = c("yellow", "red")) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Prevalence of childhood wasting by weight-for-height z-score {#whz}

```{r whz1table, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_anthro(df = create_canthro(df = childAnthro, x = anthroDF)) %>%
  create_anthro_table(vars = c("whz", "gam.whz", "mam.whz", "sam.whz"))

tab[  , 4:ncol(tab)] <- tab[  , 4:ncol(tab)] * 100
```

Global acute malnutrition by WHZ in Kayin state goes as high as 7% in urban areas and 6% in hard-to-reach areas and as low as 4% in rural areas. Rural areas had the lowest prevalence of both moderate and severe wasting by WHZ. Urban areas had the highest rate of moderate wasting and severe wasting followed closely by those in hard-to-reach areas. Children in rural areas had the lowest prevalence of moderate and severe wasting by WHZ (see Table \@ref(tab:whz2table) and Figure \@ref(fig:whzPlot)).

```{r whz2table, echo = FALSE, eval = TRUE}
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Child wasting by weight-for-height z-score",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Weight-for-height\nz-score",
                                     "Global\nacute\nmalnutrition\n(\\%)",
                                     "Moderate\nacute\nmalnutrition\n(\\%)",
                                     "Severe\nacute\nmalnutrition\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3),
                        italic = TRUE)
```

```{r whzPlot, echo = FALSE, eval = TRUE, fig.cap = "Prevalence of childhood wasting by weight-for-height z-score", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = mam.whz:sam.whz,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Moderate wasting by WHZ", 
                                        "Severe wasting by WHZ"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5, alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 5) +
  #facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = c("yellow", "red")) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Prevalence of childhood wasting by MUAC {#muac}

```{r muac1table, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_anthro(df = create_canthro(df = childAnthro, x = anthroDF)) %>%
  create_anthro_table(vars = c("muac", "gam.muac", "mam.muac", "sam.muac"))

tab[  , 4:ncol(tab)] <- tab[  , 4:ncol(tab)] * 100
```

Global acute malnutrition by MUAC in Kayin state goes as high as 6% in hard-to-reach areas and as low as 2% in urban and rural areas. There is a geographical gradient in the childhood acute malnutrition indicator such that urban areas tend to have the lowest prevalence whilst the hard-to-reach areas had the highest. This trend is consistent for moderate acute malnutrition and severe acute malnutrition. However, rural areas have a peculiar pattern in that the rate of moderate wasting by MUAC is lower than the rate of severe wasting which is an uncommon pattern (see Table \@ref(tab:muac2table) and Figure \@ref(fig:muacPlot)).

```{r muac2table, echo = FALSE, eval = TRUE}
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Child wasting by MUAC",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "MUAC\n(cm)",
                                     "Global\nacute\nmalnutrition\n(\\%)",
                                     "Moderate\nacute\nmalnutrition\n(\\%)",
                                     "Severe\nacute\nmalnutrition\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3),
                        italic = TRUE)
```

```{r muacPlot, echo = FALSE, eval = TRUE, fig.cap = "Prevalence of childhood wasting by MUAC", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = mam.muac:sam.muac,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Moderate wasting by MUAC", 
                                        "Severe wasting by MUAC"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5, alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 5) +
  #facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = c("yellow", "red")) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Infant and young child feeding {#iycf-results}

Infant and young child feeding indicators show that most mothers initiated breastfeeding early when they gave birth to their children who is less than 24 months old. However, exclusivity of breastfeeding is not maintained hence the significantly low levels of exclusive breastfeeding. Only up to 24% in urban areas and 20% in rural areas and 26%% in wealthiest and wealthy households are children consuming the minimum meal frequency required with hard-to-reach areas having the lowest at 10% and the poorest having 15%. Minimum dietary diversity goes up to 38% in urban areas and 33% in rural areas but then dropping significantly in hard-to-reach areas to 15%. Only 13% of poorest households have their children consume minimally diverse diets. Given low minimum meal frequency and low minimum dietary diversity, children with minimum acceptable diets are also low with only up to 12% of those in urban areas, 19% in rural areas and 10% for hard-to-reach areas. Only 3% of poorest households feed their children with the minimum acceptable diet (see Table \@ref(fig:iycf1table) and Figure \@ref(fig:iycf1plot) and Figure \@ref(fig:iycf2plot)).

```{r iycf1table, echo = FALSE, eval = TRUE}
tab <- recode_iycf(df = create_iycf(df = iycf, x = hh, y = hhMembers)) %>%
  create_unweighted_table(vars = c("eibf", "ebf", "mmf", "mdd", "mad"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Infant and young child feeding",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Early\ninitiation\nof\nbreastfeeding\n(\\%)",
                                     "Exclusive\nbreastfeeding\n(\\%)",
                                     "Minimum\nmeal\nfrequency\n(\\%)",
                                     "Minimum\ndietary\ndiversity\n(\\%)", 
                                     "Minimum\nacceptable\ndiet\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

```{r iycf1plot, echo = FALSE, eval = TRUE, fig.cap = "Infant and young child feeding by location type", fig.width = 12, fig.height = 16, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = c(eibf, ebf, mmf, mdd, mad),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("eibf", "ebf", "mmf", "mdd", "mad"),
                             labels = c("Early initiation of breastfeeding",
                                        "Exclusive breastfeeding",
                                        "Minimum meal frequency", 
                                        "Minimum dietary diversity",
                                        "Minimum acceptable diet"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = strata,
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(indicators ~ ., scales = "free_x") +
  facet_wrap(indicators ~ ., ncol = 3) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r iycf2plot, echo = FALSE, eval = TRUE, fig.cap = "Infant and young child feeding by wealth quintiles", fig.width = 12, fig.height = 16, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = strata,
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 5) +
  #facet_grid(indicators ~ ., scales = "free_x") +
  facet_wrap(indicators ~ ., ncol = 3) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

### Maternal health {#mhealth-results}

#### Family planning {#fplan-results}

When asked about preferences of when to have next child, the range of responses from women and husbands was about 4 to 5 years with the lower end mostly being reported in hard-to-reach areas and in poor and poorest households (see Table \@ref(tab:fplan1table)). Currenlty pregnant women, on the other hand, prefer to have children sooner at about 2-4 years.

Current contraception use is highest in urban areas at 63% followed by rural areas and hard-to-reach areas at 43%. Only 36% of the poorest women use are using contraception now. Of all contraceptive devices and methods, the injectables are the most commonly used by women in all areas and in all wealth classes followed by pills (see Table \@ref(tab:fplan2table)).

Majority of women using contraptives received family planning services from the private doctor, midwife or EHO clinic with women from urban areas receiving family planning services from private doctors, those from rural areas receiving services from midwives and hard-to-reach areas from EHO clinics (see Figure \@ref(fig:fplan1plot)). Wealthier households received family planning services from government hospital, pharmacy or midwives while the poorest households receive services from the EHO clinics (see Figure \@ref(fig:fplan2plot)).

A large proportion of women in urban and rural areas and wealthiest and wealthy households have received information on family planning. either from the hospital or from a midwife (see Table \@ref(tab:fplan4table)). Majority of women regardless of location and regardless of wealth class know basic family planning knoweldge (see Table \@ref(tab:fplan4table)).

```{r fplan1table, echo = FALSE, eval = TRUE}
tab <- recode_fplan(df = hh) %>%
  create_unweighted_table(vars = c("fp1", "fp2", "fp3"))

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Months to wait until next pregnancy",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Time\nto\nwait\nfor\nnext\nchild\n(months)",
                                     "Time\nto\nwait\nfor\nnext\nchild\nfor\ncurrently\npregnant\n(months)",
                                     "Time\nto\nwait\nfor\nnext\nchild\naccording\nto\nhusband\n(months)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

```{r fplan2table, echo = FALSE, eval = TRUE}
tab <- recode_fplan(df = hh) %>%
  create_unweighted_table(vars = c("fp4", "fp5", "fp6a", "fp6b", "fp6c", "fp6d",
                                   "fp6e", "fp6f", "fp6g", "fp6h", "fp6i", "fp6j",
                                   "fp6k", "fp6l", "fp6m", "fp6n"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Use of contraceptive methods",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Using\ncontraceptives\nnow\n(\\%)", 
                                     "Used\ncontraceptives\nbefore\n(\\%)",
                                     "Female\nsterilisation\n(\\%)",
                                     "Male\nsterilisation\n(\\%)",
                                     "IUD\n(\\%)",
                                     "Implant\n(\\%)",
                                     "Injectable\n(\\%)",
                                     "Pills\n(\\%)",
                                     "Male\ncondom\n(\\%)",
                                     "Female\ncondom\n(\\%)",
                                     "Lactational\namenorrhea\n(\\%)",
                                     "Rhythm\nmethod\n(\\%)",
                                     "Withdrawal\n(\\%)",
                                     "Emergency\ncontraception\n(\\%)",
                                     "Diaphragm\n(\\%)",
                                     "Foam/jelly\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 6) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Contraceptive methods" = 14)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r fplan1plot, echo = FALSE, eval = TRUE, fig.cap = "Use of contraceptive methods by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = fp6a:fp6n,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("fp6", letters[1:14], sep = ""),
                             labels = c("Female sterilisation",
                                        "Male sterilisation",
                                        "IUD", 
                                        "Implant",
                                        "Injectable",
                                        "Pills",
                                        "Male condom",
                                        "Female condom",
                                        "Lactational amenorrhea",
                                        "Rhythm method",
                                        "Withdrawal",
                                        "Emergency contraception",
                                        "Diaphragm",
                                        "Foam/jelly"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fplan2plot, echo = FALSE, eval = TRUE, fig.cap = "Use of contraceptive methods by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

```{r fplan3table, echo = FALSE, eval = TRUE}
tab <- recode_fplan(df = hh) %>%
  create_unweighted_table(vars = c("fp7a", "fp7b", "fp7c", "fp7d", "fp7e", 
                                   "fp7f", "fp7g", "fp7h", "fp7i", "fp7j",
                                   "fp7k"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Where contraception services received",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Government\nhospital\n(\\%)",
                                     "Government\nhealth\ncentre\n(\\%)",
                                     "Government\nvillage\nhealth\nworker\n(\\%)",
                                     "UHC/MCH\ncentre\n(\\%)",
                                     "Private\nhospital\n(\\%)",
                                     "Private\ndoctor\n(\\%)",
                                     "Pharmacy\n(\\%)",
                                     "NGO\n(\\%)",
                                     "EHO\nclinic\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)",
                                     "Midwife\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r fplan3plot, echo = FALSE, eval = TRUE, fig.cap = "Service providers for contraception methods/devices by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = fp7a:fp7k,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("fp7", letters[1:11], sep = ""),
                             labels = c("Government hospital",
                                        "Government health centre",
                                        "Government village health worker", 
                                        "UHC/MCH centre",
                                        "Private hospital",
                                        "Private doctor",
                                        "Pharmacy",
                                        "NGO",
                                        "EHO clinic",
                                        "Auxilliary midwife",
                                        "Midwife"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fplan4plot, echo = FALSE, eval = TRUE, fig.cap = "Service providers for contraception methods/devices by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

```{r fplan4table, echo = FALSE, eval = TRUE}
tab <- recode_fplan(df = hh) %>%
  create_unweighted_table(vars = c("fp8", 
                                   "fp9a", "fp9b", "fp9c", "fp9d", "fp9e", 
                                   "fp9f", "fp9g", "fp9h", "fp9i", "fp9j",
                                   "fp9k", "fp10"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Information on family planning/contraception",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Received\nfamily\nplanning\ninformation\n(\\%)",
                                     "Government\nhospital\n(\\%)",
                                     "Government\nhealth\ncentre\n(\\%)",
                                     "Government\nvillage\nhealth\nworker\n(\\%)",
                                     "UHC/MCH\ncentre\n(\\%)",
                                     "Private\nhospital\n(\\%)",
                                     "Private\ndoctor\n(\\%)",
                                     "Pharmacy\n(\\%)",
                                     "NGO\n(\\%)",
                                     "EHO\nclinic\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)",
                                     "Midwife\n(\\%)",
                                     "Appropriate\nfamily\nplanning\nknowledge\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 3, "Source of family planning information" = 11, " " = 1)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r fplan5plot, echo = FALSE, eval = TRUE, fig.cap = "Information provider for family planning/contraception by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = fp9a:fp9k,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("fp9", letters[1:11], sep = ""),
                             labels = c("Government hospital",
                                        "Government health centre",
                                        "Government village health worker", 
                                        "UHC/MCH centre",
                                        "Private hospital",
                                        "Private doctor",
                                        "Pharmacy",
                                        "NGO",
                                        "EHO clinic",
                                        "Auxilliary midwife",
                                        "Midwife"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r fplan6plot, echo = FALSE, eval = TRUE, fig.cap = "Information provider for family planning/contraception by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Urban", "Rural", "Hard-to-reach") & tabLong$state == "Kayin", ],
       mapping = aes(x = reorder_within(x = indicators, by = -estimate, within = strata),
                     y= estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 1), size = 3) +
  scale_x_reordered() +
  facet_grid(. ~ strata, scales = "free_x") +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(size = 10, angle = 90, vjust = 0.5, hjust = 1))
```

#### Antenatal care {#anc}

##### Antenatal care coverage {#ancCoverage}

Only up to 26% of women in rural areas had at least one ANC visit with a skilled/trained health professional. Slightly lesser proportion of women in urban areas (23%) had at least one ANC visit with a skilled/trained health professional. Women in hard-to-reach areas had the significantly lower proportion of women who had at least one ANC visit with a skilled/trained health professional at 11% (see Figure \@ref(fig:anc1plot)). Across wealth classes, the wealthiest and the poorest women had the lowest proportion of women who had at least one ANC visit with a skilled/trained health professional at 16% and 18% respectively (see Figure \@ref(fig:anc2plot)). This proportion doesn't improve with at least 4 ANC visits with any health professional or service provider (see Figure \@ref(fig:anc1plot) and Figure \@ref(fig:anc2plot)). Incurring costs for ANC is dictated by location and by wealth with those in urban and hard-to-reach areas most often having to pay for ANC-related costs whilst those in rural areas less so (see Table \@ref(tab:anc1table)). A similar pattern exist across wealth classes with wealthiest and wealthy women most often have to pay for ANC-related costs whilst poor and poorest women not as often. With regard to amount of costs incurred, women in urban and hard-to-reach areas pay on average more than those in rural areas. When assessed by wealth classes, mean costs incurred for ANC visits is highest for the wealthiest and for the poorest. This might indicate thate the wealthiest are spending over and above routine ANC care and services because they can afford it whilst the poorest only attend ANC when there is something seriously wrong with the pregnancy which necessitates much costly type of care.

```{r anc1table, echo = FALSE, eval = TRUE}
tab <- recode_anc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past"), 
                  status = "past") %>%
  create_unweighted_table(vars = c("anc1", "anc4", "incurCost", "amountCost", 
                                   "transportCost", "registrationCost",
                                   "medicineCost", "labCost", "providerCost", 
                                   "giftCost", "borrow"))

tab[ , c(3:5, 7:ncol(tab))] <- tab[ , c(3:5, 7:ncol(tab))] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Antenatal care coverage",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "One\nANC\nvisit\n(\\%)",
                                     "Four\nANC\nvisits\n(\\%)",
                                     "Incur\ncost\nfor\nANC?\n(\\%)",
                                     "Cost\namount\n(MMK)",
                                     "Transport\n(\\%)",
                                     "Registration\n(\\%)",
                                     "Medicine\n(\\%)",
                                     "Laboratory\n(\\%)",
                                     "Provider\n(\\%)",
                                     "Gifts\n(\\%)",
                                     "Took\na\nloan?\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 6, "Costs incurred for ANC services" = 6, " ")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r anc1plot, echo = FALSE, eval = TRUE, fig.cap = "Antenatal care coverage by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = c(anc1, anc4),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("anc1", "anc4"),
                             labels = c("At least one ANC visit with skilled health worker",
                                        "At least four ANC visit with any service provider"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r anc2plot, echo = FALSE, eval = TRUE, fig.cap = "Antenatal care coverage by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  #facet_grid(indicators ~ ., scales = "free_x") +
  facet_wrap(indicators ~ ., ncol = 2) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r anc1Table, echo = FALSE, eval = TRUE}
tab <- recode_anc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past"), 
                  status = "past") %>%
  create_unweighted_table(vars = c("specialist", "doctor", "nurse", "ha", 
                                   "pdoc", "lhv", "midwife", "amw", "tba", 
                                   "chw", "ehw"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Antenatal care service providers",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Specialist\n(\\%)",
                                     "Doctor\n(\\%)",
                                     "Nurse\n(\\%)",
                                     "Health\nassistant\n(\\%)",
                                     "Private\ndoctor\n(\\%)",
                                     "Lady\nhealth\nvisitor\n(\\%)",
                                     "Midwife\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)",
                                     "Traditional\nbirth\nattendant\n(\\%)",
                                     "Community\nhealth\nworker\n(\\%)",
                                     "Ethnic\nhealth\nworkers\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r anc1Plot, echo = FALSE, eval = TRUE, fig.cap = "Antenatal care service providers by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = c(specialist, doctor, nurse, ha, 
                                        pdoc, lhv, midwife, amw, tba, 
                                        chw, ehw),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("specialist", "doctor", "nurse", "ha", 
                                        "pdoc", "lhv", "midwife", "amw", "tba", 
                                        "chw", "ehw"),
                             labels = c("Specialist",
                                        "Doctor",
                                        "Nurse",
                                        "Health assistant",
                                        "Private doctor",
                                        "Lady health visitor",
                                        "Midwife",
                                        "Auxilliary midwife",
                                        "Traditional birth attendant",
                                        "Community health worker",
                                        "Ethnic health worker"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0") +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r anc2Plot, echo = FALSE, eval = TRUE, fig.cap = "Antenatal care service providers by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0") +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

\newpage

##### Antenatal care counselling {#ancCounselling}

Majority of women in rural and hard-to-reach areas received ANC counselling (87% and 83% respectively) whilst only 78% of women from urban areas do attend. Across wealth classes, attendance of ANC counselling is roughly the same. A third of women in urban areas and wealthy and wealthiest women restricted eating certain foods during their most recent pregnancy (see Table \@ref(tab:anc2table)). 

```{r anc2table, echo = FALSE, eval = TRUE}
tab <- recode_anc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past"),
                  status = "past") %>%
  create_unweighted_table(vars = c("counsel", "restrict", "restrictVeg", 
                                   "restrictFruits", "restrictGrains", 
                                   "restrictMeat", "restrictFish", 
                                   "restrictDairy"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Antenatal care counselling",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Attended\nANC\ncounselling\n(\\%)",
                                     "Restricted\neating\ncertain\nfoods?\n(\\%)",
                                     "Vegetables\n(\\%)",
                                     "Fruits\n(\\%)",
                                     "Grains\n(\\%)",
                                     "Meat\n(\\%)",
                                     "Fish\n(\\%)",
                                     "Dairy\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Restricted eating..." = 6)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

##### Antenatal care supplementation {#ancSupplementation}

Consumption of vitamin B1 during pregnancy was most common among urban women at 80% followed closely by women from rural areas at 76%. Women from hard-to-reach areas consumed the least at 64%. Iron-folic acid consumption follows a similar pattern with urban women consuming IFA the most at 94% followed by women from rural areas at 86%. Women from hard-to-reach areas consumed the least at 64% (see Figure \@ref(fig:anc3Plot)). Across wealth classes, vitamin B1 and IFA consumption during pregnancy decreases from wealthiest to poorest women (see Figure \@ref(fig:anc4Plot)). The number of days IFA tablet was taken was at least more than 100 days with length of consumption highest in urban and rural areas and amongst wealthy and wealthiest women. Those in urban areas got their IFA supplements mainly from the government hospital while those from rural and hard-to-reach areas got theirs from the SRHC/RHC and EHO clinics respectively. The wealthier the woman the more likely that they would have recieved IFA supplements from the government hospital. The poorer the woman the more likely that they would have received IFA supplements from the EHO clinic or the SRHC/RHC (see Table \@ref(tab:anc3table)).

```{r anc3table, echo = FALSE, eval = TRUE}
tab <- recode_anc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past"),
                  status = "past") %>%
  create_unweighted_table(vars = c("b1", "ifa1", "ifa2", "ifa3", 
                                   "ifa4a", "ifa4b", "ifa4c", "ifa4d", "ifa4e"))

tab[ , c(3:4, 7:ncol(tab))] <- tab[ , c(3:4, 7:ncol(tab))] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Antenatal care supplementation",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Vitamin\nB1\n(\\%)",
                                     "Iron\nfolic\nacid\n(\\%)",
                                     "No.\nof\ndays\nIFA\ntaken\n(days)",
                                     "Cost\nof\nIFA\n(MMK)",
                                     "Government\nhospital\n(\\%)",
                                     "EHO\nclinic\n(\\%)",
                                     "Private\ndoctor/\nclinic\n(\\%)",
                                     "SRHC/\nRHC\n(\\%)",
                                     "Routine\nANC\nlocation\nin\nvillage/ward\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 6, "Source of iron-folic acid tablets" = 5)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

```{r anc3Plot, echo = FALSE, eval = TRUE, fig.cap = "Antenatal care supplementation by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = c(b1, ifa1),
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("b1", "ifa1"),
                             labels = c("Vitamin B1 supplementation",
                                        "Iron-folic acid supplementation"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r anc4Plot, echo = FALSE, eval = TRUE, fig.cap = "Antenatal care supplementation by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

##### Antenatal care testing {#ancTesting}

Only 19% of women in urban areas and 18% in rural areas had tests done during their ANC whilst only 3% of women in hard-to-reach areas had tests done. The poor and poorest women had the least testing done at 11% and 6% respectively. Majority of the tests done is for HIV/AIDS in rural and urban areas and among wealthiest women. The SRHC was the predominant provider of ANC teseting services. About a quarter to a third of women incurred costs for ANC testing across various locations and across wealth classes (see Table \@ref(tab:anc4table)).

```{r anc4table, echo = FALSE, eval = TRUE}
tab <- recode_anc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past"),
                  status = "past") %>%
  create_unweighted_table(vars = c("test1", "test2a", "test2b", "test2c", "test2d", 
                                   "test3a", "test3b", "test3c", "test3d", "test3e",
                                   "test4", "test5"))

tab[ , 3:(ncol(tab) - 1)] <- tab[ , 3:(ncol(tab) - 1)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Antenatal care testing",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Tests\ndone?\n(\\%)",
                                     "Hepatitis\nB\n(\\%)",
                                     "Hepatitis\nC\n(\\%)",
                                     "HIV/AIDS\n(\\%)",
                                     "Syphillis\n(\\%)",
                                     "Government\nhospital\n(\\%)",
                                     "EHO\nclinic\n(\\%)",
                                     "Private\ndoctor/\nclinic\n(\\%)",
                                     "SRHC/\nRHC\n(\\%)",
                                     "Routine\nANC\nlocation\nin\nvillage/ward\n(\\%)",
                                     "Incur\ncosts?\n(\\%)",
                                     "Cost\namount\n(MMK)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 3, "Type of test" = 4, "Location test was done" = 5, " " = 2)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

#### Birth/delivery {#birth}

About 36 week gestational age was the average when women gave birth in Kayin state (see Table \@ref(tab:gestAgetable)).

```{r gestAgetable, echo = FALSE, eval = TRUE}
tab <- recode_birth(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = "gestage")

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Gestational age at birth (weeks)",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", "Gestational\nage\n(weeks)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

Women in urban areas mostly gave birth in government hospitals while women from rural areas gave birth either at home or in government hospital. Almost all of women in hard-to-reach areas delivered at home. Women from poor and poorest households mostly delivered at home (see Table \@ref(tab:birth1table), Figure \@ref(fig:birth1Plot) and Figure \@ref(fig:birth2Plot)).

```{r birth1table, echo = FALSE, eval = TRUE}
tab <- recode_birth(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("birth1a", "birth1b", "birth1c", "birth1d", "birth1e", "birth1f"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100
  
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Location of birth/delivery",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Home\n(\\%)",
                                     "Government\nhospital\n(\\%)",
                                     "Private\ndoctor/\nclinic\n(\\%)",
                                     "SRHC/RHC\n(\\%)",
                                     "Routine\nANC\nlocation\nin\nvillage\n(\\%)",
                                     "EHO\nclinic\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

```{r birth1Plot, echo = FALSE, eval = TRUE, fig.cap = "Location for birth/delivery by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = birth1a:birth1f,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("birth1a", "birth1b", "birth1c", 
                                        "birth1d", "birth1e", "birth1f"),
                             labels = c("Home",
                                        "Government hospital",
                                        "Private doctor/clinic",
                                        "SHRC/RHC",
                                        "Routine ANC location in village",
                                        "EHO clinic"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r birth2Plot, echo = FALSE, eval = TRUE, fig.cap = "Location for birth/delivery by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

Convenience, tradition and affordable cost were the main reasons for delivering at home for women in hard-to-reach areas. On the other hand, safety for mother and baby was the main reason for delivering in government hospitals for women in rural and urban areas (see Table \@ref(tab:birth2table) and Figure \@ref(fig:birth3Plot)). The same trend was noted in wealth classes in that the wealthier the mother, the more that safety of mothers and babies was considered for choice of birth/delivery location and the poorer the mother the more that convenience and tradition and cost were the reasons for cohice of birth/delivery location (see Figure \@ref(fig:birth4Plot)). 

```{r birth2table, echo = FALSE, eval = TRUE}
tab <- recode_birth(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("birth2a", "birth2b", "birth2c", "birth2d", "birth2e"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100
  
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Reason for choosing birth/delivery location",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Convenience\n(\\%)",
                                     "Tradition\n(\\%)",
                                     "Close\ndistance\n(\\%)",
                                     "Safety\nfor\nmother/baby\n(\\%)",
                                     "Affordable\ncost\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

```{r birth3Plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for choice of birth/delivery location by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = birth2a:birth2e,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("birth2a", "birth2b", "birth2c", 
                                        "birth2d", "birth2e"),
                             labels = c("Convenience",
                                        "Tradition",
                                        "Close distance",
                                        "Safety for mother and baby",
                                        "Affordable cost"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r birth4Plot, echo = FALSE, eval = TRUE, fig.cap = "Reasons for choice of birth/delivery location by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

Births/deliveries were mostly assisted by doctors and midwives in urban and rural areas. On the other hand, traditional birth attendants were the ones that women in hard-to-reach areas rely on when they give birth/deliver (see Table \@ref(tab:birth3table) and Figure \@ref(fig:birth5Plot)). A similar trend by wealth was noted in that wealtheir women were mostly assisted by doctors and midwives while poorer women were mostly assisted by traditional birth attendants or relatives (see Figure \@ref(fig:birth6Plot)).

```{r birth3table, echo = FALSE, eval = TRUE}
tab <- recode_birth(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("birth3a", "birth3b", "birth3c", "birth3d", 
                                   "birth3e", "birth3f", "birth3g", "birth3h", 
                                   "birth3i"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Who assisted in birth/delivery",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Doctor\n(\\%)",
                                     "Nurse\n(\\%)",
                                     "Lady\nhealth\nvisitor\n(\\%)",
                                     "Midwife\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)",
                                     "Traditional\nbirth\nattendant\n(\\%)",
                                     "On\nmy\nown\n(\\%)",
                                     "Relatives\n(\\%)",
                                     "EHO\ncadres\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

```{r birth5Plot, echo = FALSE, eval = TRUE, fig.cap = "Service provider for birth/delivery location by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = birth3a:birth3i,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("birth3", letters[1:9], sep = ""),
                             labels = c("Doctor",
                                        "Nurse",
                                        "Lady health visitor",
                                        "Midwife",
                                        "Auxilliary midwife",
                                        "Traditional birth attendant",
                                        "On my own",
                                        "Relatives",
                                        "EHO cadres"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r birth6Plot, echo = FALSE, eval = TRUE, fig.cap = "Service provider for birth/delivery location by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

Majority of children were born via normal delivery in rural and hard-to-reach areas whilst in urban areas, about 70% of deliveries were normal and a third are caesarian deliveries (see Table \@ref(tab:birth4table)). Almost half of wealthier women delivered via caesarian section.

```{r birth4table, echo = FALSE, eval = TRUE}
tab <- recode_birth(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("birth4a", "birth4b", "birth4c", "birth4d"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Birth/delivery method",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Normal\n(\\%)",
                                     "Caesarian\n(\\%)",
                                     "Vacuum\n(\\%)",
                                     "Forceps\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

Costs for birth/delivery were incurred by at least three quarters of the women surveyed with women in hard-to-reach areas having the lowest proportion of those incurring costs at 73% and almost all of women in urban and rural areas incurring costs. Most households who are wealthy incur costs when giving birth/delivery while three quarters of households that are poor incur costs. Urban and rural women and wealthy and wealthiest women incur the most costs when giving birth (see Table \@ref(tab:birth5table)).

```{r birth5table, echo = FALSE, eval = TRUE}
tab <- recode_birth(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("birth5", "birth6", "birth7"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100
  
knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Costs incurred for birth/delivery",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Incurred\ncosts?\n(\\%)",
                                     "Delivery\ncost\n(MMK)",
                                     "Took\na\nloan?\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

#### Postnatal care {#pnc}

Coverage of postnatal care is above 50% of women in urban and rural areas but significantly lower in hard-to-reach areas at a little over a third of women (see Table \@ref(tab:pnc1table) and Figure \@ref(fig:pnc1Plot)). More women who are wealthier are covered by postnatal care services whilst much lesser proportion of women who are poor are provided with postnatal care (see Table \@ref(tab:pnc1table) and Figure \@ref(fig:pnc2Plot)).

```{r pnc1table, echo = FALSE, eval = TRUE}
tab <- recode_pnc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("pnc1", "pnc2", 
                                   "pnc3a", "pnc3b", "pnc3c", "pnc3d", "pnc3e", 
                                   "pnc3f", "pnc3g", "pnc3h"))

tab[ , c(3, 5:ncol(tab))] <- tab[ , c(3, 5:ncol(tab))] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Postnatal care coverage",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Received\npostnatal\ncare\n(\\%)",
                                     "Time\nto\ncare\n(days)",
                                     "Doctor\n(\\%)",
                                     "Nurse\n(\\%)",
                                     "Lady\nhealth\nvisitor\n(\\%)",
                                     "Midwife\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)",
                                     "Traditional\nbirth\nattendant\n(\\%)",
                                     "Relatives\n(\\%)",
                                     "EHO\ncadres\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 7) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Provider of postnatal care" = 8)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

```{r pnc1Plot, echo = FALSE, eval = TRUE, fig.cap = "Post-natal care coverage by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = pnc1,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = "pnc1",
                             labels = "Post-natal care coverage")

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  #facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r pnc2Plot, echo = FALSE, eval = TRUE, fig.cap = "Post-natal care coverage by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  #facet_wrap(indicators ~ ., ncol = 3) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

Most women from urban areas received their postnatal care from doctors while most women from rural and hard-to-reach areas got postnatal care from midwives, auxilliary midwives, traditional birth attendants or EHO clinics (see Figure \@ref(fig:pnc3Plot)). Most women who are wealthy received posnatal care from doctors and most women who are poor received postnatal care from midwives, auxilliary midwives, traditional birth attendants or EHO clinics (see Figure \@ref(fig:pnc3Plot)).

```{r pnc3Plot, echo = FALSE, eval = TRUE, fig.cap = "Post-natal care service provider by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = pnc3a:pnc3h,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("pnc3", letters[1:8], sep = ""),
                             labels = c("Doctor",
                                        "Nurse",
                                        "Lady health visitor",
                                        "Midwife",
                                        "Auxilliary midwife",
                                        "Traditional birth attendant",
                                        "Relatives",
                                        "Ethnic health organisation"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r pnc4Plot, echo = FALSE, eval = TRUE, fig.cap = "Post-natal care service provider by wealth quintile", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r pnc2table, echo = FALSE, eval = FALSE}
tab <- recode_pnc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = "pnc5")

tab[ , 3] <- tab[ , 3] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Vitamin B1 supplementation",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Vitamin\nB1\nsupplementation\nduration\n(weeks)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

Up to 40% of women in rural areas incur costs for post-natal care followed by women from hard-to-reach areas at 32%. Women in urban areas incurred costs the least at 21%. The most common cost is for medicines (see Table \@ref(tab:pnc3table)).

```{r pnc3table, echo = FALSE, eval = TRUE}
tab <- recode_pnc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("pnc6", 
                                   "pnc7a", "pnc7b", "pnc7c", 
                                   "pnc7d", "pnc7e", "pnc7f"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Costs of postnatal care",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Costs\nincurred?\n(\\%)",
                                     "Transportation\n(\\%)",
                                     "Registration\n(\\%)",
                                     "Medicine\n(\\%)", 
                                     "Laboratory\nfees\n(\\%)",
                                     "Provider\nfees\n(\\%)", 
                                     "Gifts\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 3, "Reason for costs" = 6)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

#### Newborn care {#nbc}

Almost all women in urban areas and slightly more than 50% of women in rural areas received newborn care within 24 hours of delivery but only a third of women in hard-to-reach areas receive newborn care within 24 hours (see Table \@ref(tab:nbc1table) and Figure \@ref(fig:nbc1Plot)). These rates stay the same when newborn care within 48 hours is considered. A greater proportion of women who are wealthy receive newborn care within 24 hours or within 48 hours while a much lesser proportion of women who are poor recieve this care (see Figure \@ref(fig:nbc2Plot)).

```{r nbc1table, echo = FALSE, eval = TRUE}
tab <- recode_nbc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("nbc1", "nbc2",
                                   "nbc3a", "nbc3b", "nbc3c", "nbc3d", 
                                   "nbc3e", "nbc3f", "nbc3g", "nbc3h"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Newborn care coverage",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Newborn\ncare\nwithin\n24 hours\n(\\%)",
                                     "Newborn\ncare\nwithin\n48 hours\n(\\%)",
                                     "Doctor\n(\\%)",
                                     "Nurse\n(\\%)",
                                     "Lady\nhealth\nvisitor\n(\\%)",
                                     "Midwife\n(\\%)",
                                     "Auxilliary\nmidwife\n(\\%)",
                                     "Traditional\nbirth\nattendant\n(\\%)",
                                     "Relatives\n(\\%)",
                                     "EHO\ncadres\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 7) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Provider of newborn care" = 8)) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

```{r nbc1Plot, echo = FALSE, eval = TRUE, fig.cap = "Newborn care coverage by location type", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = nbc1:nbc2,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c("nbc1", "nbc2"),
                             labels = c("Newborn care within 24 hours", 
                                        "Newborn care within 48 hours"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r nbc2Plot, echo = FALSE, eval = TRUE, fig.cap = "Newborn care coverage by wealth quintiles", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

Women in urban areas receive newborn care mostly from doctors and women from rural areas receive newborn care either from doctors or midwives. Women from hard-to-reach areas predominantly receive newborn care from midwives, auxilliary midwives and traditional birth attendants (see Figure \@ref(fig:nbc3Plot) and Figure \@ref(fig:nbc4Plot)).

```{r nbc3Plot, echo = FALSE, eval = TRUE, fig.cap = "Newborn care service provider by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = nbc3a:nbc3h,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("nbc3", letters[1:8], sep = ""),
                             labels = c("Doctor",
                                        "Nurse",
                                        "Lady health visitor",
                                        "Midwife",
                                        "Auxilliary midwife",
                                        "Traditional birth attendant",
                                        "Relatives",
                                        "Ethnic health organisation"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r nbc4Plot, echo = FALSE, eval = TRUE, fig.cap = "Newborn care service provider by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

A relatively low proportion of newborn care received by most women incurred costs with much lesser women in hard-to-reach areas paying for newborn care (see Table \@ref(tab:nbc2table), Figure \@ref(fig:nbc5Plot) and Figure \@ref(fig:nbc6Plot)). Almost all of these costs are for medications.

```{r nbc2table, echo = FALSE, eval = TRUE}
tab <- recode_nbc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("nbc5", "nbc6",
                                   "nbc7a", "nbc7b", "nbc7c", "nbc7d", 
                                   "nbc7e", "nbc7f", "nbc8"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Costs of newborn care",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Costs\nincurred?\n(\\%)",
                                     "Cost\namount\n(MMK)",
                                     "Transportation\n(\\%)",
                                     "Registration\n(\\%)",
                                     "Medicine\n(\\%)", 
                                     "Laboratory\nfees\n(\\%)",
                                     "Provider\nfees\n(\\%)", 
                                     "Gifts\n(\\%)",
                                     "Took\na\nloan?\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 10) %>%
  kableExtra::add_header_above(header = c(" " = 4, "Reason for costs" = 6, " ")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) %>%
  landscape()
```

```{r nbc5Plot, echo = FALSE, eval = TRUE, fig.cap = "Costs for newborn care by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = nbc7a:nbc7f,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = paste("nbc7", letters[1:6], sep = ""),
                             labels = c("Transportation",
                                        "Registration",
                                        "Medicine",
                                        "Laboratory fees",
                                        "Provider fees",
                                        "Gifts"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r nbc6Plot, echo = FALSE, eval = TRUE, fig.cap = "Costs for newborn care by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

Majority of women interviewed fed their newborn children colostrum from their breastmilk (see Table \@ref(tab:nbc3table)).

```{r nbc3table, echo = FALSE, eval = TRUE}
tab <- recode_nbc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = "nbc9")

tab[ , 3] <- tab[ , 3] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Fed colostrum to newborn",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Fed\ncolostrum\nto\nnewboarn\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

Very few women across locations and wealth class are able to identify key dangers signs to watch out for in the newborn (see Figure \@ref(fig:nbc7Plot)). A great proportion of women cannot identify any danger sign and this proportion increases from urban to rural to hard-to-reach areas and from wealthiest to poorest households (see Figure \@ref(fig:nbc8Plot)).

```{r nbc4table, echo = FALSE, eval = TRUE}
tab <- recode_nbc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("nbc10a", "nbc10b", "nbc10c", "nbc10d", "nbc10e",
                                   "nbc10f", "nbc10g", "nbc11"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Knowledge of danger signs",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Feeding\nless\n(\\%)",
                                     "Convulsion\n(\\%)",
                                     "High/low\ntemperature\n(\\%)",
                                     "Local\ninfection\n(\\%)",
                                     "No\nless\nmovement\n(\\%)",
                                     "Fast/\ndifficulty\nbreathing\n(\\%)",
                                     "Yellow\nskin\n(\\%)",
                                     "Does\nnot\nknow\nany\ndanger\nsigns\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::add_header_above(header = c(" " = 2, "Danger signs" = 7, " ")) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE) #%>%
  #landscape()
```

```{r nbc7Plot, echo = FALSE, eval = TRUE, fig.cap = "Knowledge of danger signs by location type", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = nbc10a:nbc11,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators,
                             levels = c(paste("nbc10", letters[1:7], sep = ""), "nbc11"),
                             labels = c("Feeding less",
                                        "Convulsion",
                                        "High/low temperature",
                                        "Local infection",
                                        "No/less movement",
                                        "Fast/difficulty breathing",
                                        "Yellow skin",
                                        "Does not know any danger signs"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

```{r nbc8Plot, echo = FALSE, eval = TRUE, fig.cap = "Costs for newborn care by wealth quintiles", fig.width = 12, fig.height = 15, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[!tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate)) +
  geom_col(width = 0.5, colour = "#70C1B3", fill = "#247BA0", alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 3) +
  #facet_grid(indicators ~ .) +
  facet_wrap(indicators ~ ., ncol = 2) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = rev(brewer.pal(n = 4, "RdYlGn"))) +
  labs(x = "", y = "%") +
  themeSettings
```

\newpage

A high proportion of women practice inappropriate delivery wound care and umbilical cord stump care (see Table \@ref(tab:nbc5table)). This proportion increases from urban to rural to hard-to-reach women and from wealthiest to poorest women.

```{r nbc5table, echo = FALSE, eval = TRUE}
tab <- recode_nbc(df = create_anc(df = anc2, x = hh, y = hhMembers, status = "past")) %>%
  create_unweighted_table(vars = c("nbc13", "nbc15"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Care of cord and delivery wound",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Inappropriate\ncord\ncare\n(\\%)",
                                     "Inappropriate\ndelivery\nwound\ncare\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

\newpage

### Maternal nutrition {#mnutrition}

#### Maternal wasting {#mwasting}

There is a relatively low prevalence of maternal wasting by MUAC in Kayin state with women in rural and hard-to-reach areas having the highest proportion at 2% global wasting (see Table \@ref(tab:mMuac1table) and Figure \@ref(fig:mMuacPlot)). Moderate wasting by MUAC is about the same in urban, rural and hard-to-reach areas. Women in rural and hard-to-reach areas have about the same prevalence of severe wasting by MUAC while women in urban areas have less than half of this prevalence of severe wasting by MUAC.

```{r mMuac1table, echo = FALSE, eval = TRUE}
tab <- recode_maternal_anthro(df = motherAnthro, x = anthroDF, y = childAnthro) %>%
  create_anthro_table(vars = c("muac", "gam", "mam", "sam"))

tab[ , 4:ncol(tab)] <- tab[ , 4:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Maternal acute undernutrition",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "MUAC\n(cm)",
                                     "GAM\nMUAC\nless\nthan\n210 cm\n(\\%)",
                                     "MAM\nMUAC\nless\nthan\n210 cm\nand greater\nthan\nor equal to\n185 cm\n(\\%)",
                                     "SAM\nMUAC\nless\nthan\n185 cm\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 12) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3), italic = TRUE)
```

```{r mMuacPlot, echo = FALSE, eval = TRUE, fig.cap = "Prevalence of maternal wasting by MUAC", fig.width = 12, fig.height = 8, fig.align = "center", fig.pos = "H"}
tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = mam:sam,
                               names_to = "indicators", values_to = "estimate")

tabLong$indicators <- factor(x = tabLong$indicators, 
                             labels = c("Moderate wasting by MUAC", 
                                        "Severe wasting by MUAC"))

tabLong$state <- factor(x = tabLong$state, levels = c("Kayin", "Kayah"))
tabLong$strata <- factor(x = tabLong$strata, levels = c("Urban", "Rural", "Hard-to-reach", "Wealthiest", "Wealthy", "Medium", "Poor", "Poorest"))

ggplot(data = tabLong[tabLong$strata %in% c("Rural", "Urban", "Hard-to-reach") & tabLong$state == "Kayin", ], 
       aes(x = strata, y = estimate, fill = indicators)) +
  geom_col(width = 0.5, alpha = 0.7) +
  geom_text(aes(group = indicators, label = paste(round(estimate, digits = 1), "%", sep = "")), 
            position = position_stack(vjust = 0.5), size = 5) +
  #facet_grid(. ~ strata) +
  #scale_y_continuous(limits = c(0, 100)) +
  scale_fill_manual(values = c("yellow", "red")) +
  labs(x = "", y = "%", fill = "") +
  themeSettings
```

#### Minimum dietary diversity for women {#mddw}

Up to 75% of women in urban areas achieved minimum dietary diversity of consuming 5 out of 10 food groups in the past day followed by women in rural and hard-to-reach areas at 67% and 70% respectively. Wealthy women had the highest proportion of women achieving minimum dietary diversity while poorer women less so (see Table \@ref(tab:mddw1table))

```{r mddw1table, echo = FALSE, eval = TRUE}
tab <- recode_mddw(df = hh) %>%
  create_unweighted_table(vars = c("mddw"))

tab[ , 3:ncol(tab)] <- tab[ , 3:ncol(tab)] * 100

knitr::kable(x = tab[tab$state == "Kayin", ],
             caption = "Minimum dietary diversity for women",
             booktabs = TRUE,
             row.names = FALSE,
             col.names = linebreak(c("", "", 
                                     "Minimum dietary diversity\nfor women\n(\\%)"),
                                   align = "c"),
             escape = FALSE,
             digits = 1,
             format = "latex") %>%
  kableExtra::kable_styling(latex_options = c("HOLD_position"),
                            font_size = 9) %>%
  kableExtra::row_spec(row = 0, bold = TRUE) %>%
  kableExtra::column_spec(column = 0:ncol(tab), monospace = TRUE) %>%
  kableExtra::column_spec(column = 1:2, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1:2, row_group_label_position = "stack") %>%
  kableExtra::pack_rows(index = c("Geographic" = 3, "Wealth" = 5),
                        italic = TRUE)
```

## Cohort study {#study2-results}

For the results of the cohort study, the regression discontinuity was demonstrated through a regression plot of children's anthropometric indices and MUAC for those who were born a month before the start of recruitment for the MCCT program (control program) and those who were born a month after the start of the recruitment for the MCCT program (intervention).

An intention-to-treat analysis was applied with intervention cases were identified purely based on their eligibility for the program. Further analysis of acutal receipt of benefits from MCCT should be included at endline. Following are the results.

### Child anthropometric indicators

```{r rd1, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_anthro(df = create_canthro(df = childAnthro, x = anthroDF))

tab <- tab[tab$sample_component == 2, ]

tab <- tab[ , c("dob", "geo_state", "flag", "muac", "waz", "haz", "whz")]
studyGroup <- ifelse(tab$dob %within% interval(start = lubridate::ymd("2018/09/01"),
                                               end = lubridate::ymd("2018/09/30")), "Control", "Intervention")

tab <- data.frame(studyGroup, tab)
tab <- tab[!is.na(tab$studyGroup), ]

tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = c(muac:whz),
                               names_to = "indicators", values_to = "estimate")
```

Figure \@ref(fig:rd2a), Figure \@ref(fig:rd3a), Figure \@ref(fig:rd4a) and Figure \@ref(fig:rd5a) show regression plots of weight-for-age z-score, height-for-age z-score, weight-for-height z-score and MUAC for children in the control and the intervention groups. Control data is for those before 1 October on the x-axis (left-side of red line on the plot) and the intervention data is for those on and after 1 October on the x-axis (right-side of red line on the plot). In all these cases, no statistically significant regression discontinuity can be appreciated; that is both control and intervention cases are anthropometrically similar groups though there are beginning signs of increases noted in the intervention group.

```{r rd2, echo = FALSE, eval = FALSE, fig.cap = "Weight-for-age z-score regression discontinuity", fig.width = 8, fig.height = 6, fig.align = "center", fig.pos = "H"}
ggplot(data = tab[tab$geo_state == "MMR003", ],
       mapping = aes(x = lubridate::ymd(dob), y = waz)) +
  geom_point(pch = 21, fill = "#247BA0", alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), colour = "darkred") +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/09/01"),
                                    end = lubridate::ymd("2018/09/30")), ],
              linetype = "dashed", colour = "darkblue", 
              fill = "#247BA0", alpha = 0.3) +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/10/01"),
                                    end = lubridate::ymd("2018/10/31")), ],
              linetype = "dashed", colour = "darkgreen",
              fill = "#70C1B3", alpha = 0.3) +
  labs(x = "", y = "Weight-for-age z-score (WAZ)") +
  themeSettings
```

```{r rd2a, echo = FALSE, eval = TRUE, fig.cap = "Weight-for-age z-score regression discontinuity", fig.width = 8, fig.height = 5, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$geo_state == "MMR003" & tabLong$indicators == "waz", ],
       mapping = aes(x = lubridate::ymd(dob), y = estimate, colour = studyGroup)) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), 
             colour = "darkred", linetype = "dashed",
             size = 2) +
  geom_smooth(mapping = aes(fill = studyGroup), 
              method = "lm", fullrange = TRUE, alpha = 0.3,
              linetype = "dashed", size = 1) +
  scale_colour_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  scale_fill_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  labs(x = "", y = "Weight-for-age z-score (WAZ)") +
  themeSettings
```

```{r rd3, echo = FALSE, eval = FALSE, fig.cap = "Height-for-age z-score regression discontinuity", fig.width = 8, fig.height = 6, fig.align = "center", fig.pos = "H"}
ggplot(data = tab[tab$geo_state == "MMR003", ],
       mapping = aes(x = lubridate::ymd(dob), y = haz)) +
  geom_point(pch = 21, fill = "#247BA0", alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), colour = "darkred") +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/09/01"),
                                    end = lubridate::ymd("2018/09/30")), ],
              linetype = "dashed", colour = "darkblue", 
              fill = "#247BA0", alpha = 0.3) +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/10/01"),
                                    end = lubridate::ymd("2018/10/31")), ],
              linetype = "dashed", colour = "darkgreen",
              fill = "#70C1B3", alpha = 0.3) +
  labs(x = "", y = "Height-for-age z-score (HAZ)") +
  themeSettings
```

```{r rd3a, echo = FALSE, eval = TRUE, fig.cap = "Height-for-age z-score regression discontinuity", fig.width = 8, fig.height = 5, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$geo_state == "MMR003" & tabLong$indicators == "haz" & tabLong$flag != 1, ],
       mapping = aes(x = lubridate::ymd(dob), y = estimate, colour = studyGroup)) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), 
             colour = "darkred", linetype = "dashed",
             size = 2) +
  geom_smooth(mapping = aes(fill = studyGroup), 
              method = "lm", fullrange = TRUE, alpha = 0.3,
              linetype = "dashed", size = 1) +
  scale_colour_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  scale_fill_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  labs(x = "", y = "Height-for-age z-score (HAZ)") +
  themeSettings
```

```{r rd4, echo = FALSE, eval = FALSE, fig.cap = "Weight-for-height z-score regression discontinuity", fig.width = 8, fig.height = 6, fig.align = "center", fig.pos = "H"}
ggplot(data = tab[tab$geo_state == "MMR003", ],
       mapping = aes(x = lubridate::ymd(dob), y = whz)) +
  geom_point(pch = 21, fill = "#247BA0", alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), colour = "darkred") +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/09/01"),
                                    end = lubridate::ymd("2018/09/30")), ],
              linetype = "dashed", colour = "darkblue", 
              fill = "#247BA0", alpha = 0.3) +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/10/01"),
                                    end = lubridate::ymd("2018/10/31")), ],
              linetype = "dashed", colour = "darkgreen",
              fill = "#70C1B3", alpha = 0.3) +
  labs(x = "", y = "Weight-for-height z-score (HAZ)") +
  themeSettings
```

```{r rd4a, echo = FALSE, eval = TRUE, fig.cap = "Weight-for-height z-score regression discontinuity", fig.width = 8, fig.height = 5, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$geo_state == "MMR003" & tabLong$indicators == "whz", ],
       mapping = aes(x = lubridate::ymd(dob), y = estimate, colour = studyGroup)) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), 
             colour = "darkred", linetype = "dashed",
             size = 2) +
  geom_smooth(mapping = aes(fill = studyGroup), 
              method = "lm", fullrange = TRUE, alpha = 0.3,
              linetype = "dashed", size = 1) +
  scale_colour_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  scale_fill_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  labs(x = "", y = "Weight-for-height z-score (WHZ)") +
  themeSettings
```

```{r rd5, echo = FALSE, eval = FALSE, fig.cap = "MUAC regression discontinuity", fig.width = 8, fig.height = 6, fig.align = "center", fig.pos = "H"}
ggplot(data = tab[tab$geo_state == "MMR003", ],
       mapping = aes(x = lubridate::ymd(dob), y = muac)) +
  geom_point(pch = 21, fill = "#247BA0", alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), colour = "darkred") +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/09/01"),
                                    end = lubridate::ymd("2018/09/30")), ],
              linetype = "dashed", colour = "darkblue", 
              fill = "#247BA0", alpha = 0.3) +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/10/01"),
                                    end = lubridate::ymd("2018/10/31")), ],
              linetype = "dashed", colour = "darkgreen",
              fill = "#70C1B3", alpha = 0.3) +
  labs(x = "", y = "MUAC (cm)") +
  themeSettings
```

```{r rd5a, echo = FALSE, eval = TRUE, fig.cap = "MUAC regression discontinuity", fig.width = 8, fig.height = 5, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$geo_state == "MMR003" & tabLong$indicators == "muac", ],
       mapping = aes(x = lubridate::ymd(dob), y = estimate, colour = studyGroup)) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), 
             colour = "darkred", linetype = "dashed",
             size = 2) +
  geom_smooth(mapping = aes(fill = studyGroup), 
              method = "lm", fullrange = TRUE, alpha = 0.3,
              linetype = "dashed", size = 1) +
  scale_colour_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  scale_fill_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  labs(x = "", y = "MUAC (cm)") +
  themeSettings
```

### Maternal anthropometric indicators

```{r rd6, echo = FALSE, eval = TRUE, results = FALSE}
tab <- recode_maternal_anthro(df = motherAnthro, x = anthroDF, y = childAnthro)

## Remove 0 values
tab <- tab[tab$muac > 0, ]

tab <- tab[tab$sample_component == 2, ]

tab <- tab[ , c("dob", "geo_state", "muac")]
studyGroup <- ifelse(tab$dob %within% interval(start = lubridate::ymd("2018/09/01"),
                                               end = lubridate::ymd("2018/09/30")), "Control", "Intervention")

tab <- data.frame(studyGroup, tab)
tab <- tab[!is.na(tab$studyGroup), ]

tabLong <- tidyr::pivot_longer(data = tab, 
                               cols = muac,
                               names_to = "indicators", values_to = "estimate")
```

For maternal wasting by MUAC, a similar pattern of beginning but non-significant discontinuity can be noted as shown in Figure \@ref(fig:rd7a).

```{r rd7, echo = FALSE, eval = FALSE, fig.cap = "Maternal MUAC regression discontinuity", fig.width = 8, fig.height = 6, fig.align = "center", fig.pos = "H"}
ggplot(data = tab[tab$geo_state == "MMR003", ],
       mapping = aes(x = lubridate::ymd(dob), y = muac)) +
  geom_point(pch = 21, fill = "#247BA0", alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"),
             colour = "darkred", linetype = "dashed", size = 2) +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/09/01"),
                                    end = lubridate::ymd("2018/09/30")), ],
              method = "lm", fullrange = TRUE,
              linetype = "dashed", colour = "darkblue", 
              fill = "#247BA0", alpha = 0.3) +
  geom_smooth(data = tab[tab$dob %within% 
                           interval(start = lubridate::ymd("2018/10/01"),
                                    end = lubridate::ymd("2018/10/31")), ],
              method = "lm", fullrange = TRUE,
              linetype = "dashed", colour = "darkgreen",
              fill = "#70C1B3", alpha = 0.3) +
  labs(x = "", y = "MUAC (cm)") +
  themeSettings
```

```{r rd7a, echo = FALSE, eval = TRUE, fig.cap = "Maternal MUAC regression discontinuity", fig.width = 8, fig.height = 5, fig.align = "center", fig.pos = "H"}
ggplot(data = tabLong[tabLong$geo_state == "MMR003" & tabLong$indicators == "muac", ],
       mapping = aes(x = lubridate::ymd(dob), y = estimate, colour = studyGroup)) +
  geom_point(alpha = 0.5) +
  geom_vline(xintercept = lubridate::ymd("2018-10-01"), 
             colour = "darkred", linetype = "dashed",
             size = 2) +
  geom_smooth(mapping = aes(fill = studyGroup), 
              method = "lm", fullrange = TRUE, alpha = 0.3,
              linetype = "dashed", size = 1) +
  scale_colour_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  scale_fill_manual(values = c("darkblue", "darkgreen"), name = "Study Group") +
  labs(x = "", y = "MUAC (cm)") +
  themeSettings
```

\newpage

# Discussion and Recommendations

The results of the population-based baseline survey in Kayin State indicate that child undernutrition specifically stunting/stuntedness and underweight is one of the highest in Myanmar with children in hard-to-reach areas (which also tend to be the poorest in the state) being the worst affected in the state. Results from child health and nutrition related indicators describes the situation in the state of poor infant and young child feeding and breastfeeding practices and low coverage and access to child health services such as immunisation as immediate factors that may explain the level of child undernutrition in the state. In addition, maternal health as proxied by services for mothers during pregnancy, on giving birth and post-pregnancy indicate mostly disparate results of relative better access among wealthy women and lesser access for poorer women. Overall, most mothers who access these maternal health services pay out-of-pocket hence exacerbating the wealth disparity in access to these services. Maternal undernutrition as proxied by maternal wasting by MUAC is, however, low though dietary diversity of women is not optimal.

More distal factors such as food insecurity as proxied by food consumption, coping strategies, household food expenditure share are not at critical levels for the state on aggregate but wealth disparities with regard to these food security indicators support the idea that poverty is a distal driver of child undernutrition in the state. Water and sanitation and hygiene indicators, another distal factor impacting on child health and nutrition, though on aggregate are acceptable are much worse for poor households.

Treatment-seeking for childhood illnesses in Kayin state is to partly explained by wealth disparity though results seem to indicate a more complex mechanism of decisionmaking within households that the current results cannot completely explain.

It is within this context that the MCCT program is embedded aiming to address primarily the distal factor of poverty and its correlates so that households can address immediate and intermediate factors of access to nutritious food and access to services which in turn can impact on the child undernutrition situation specifically stunting. However, the results of the population-based survey indicate that current coverage of the MCCT program in Kayin state is too low to possibly make an impact.

The results from the cohort of intervention and control mother and children recruited for the evaluation component of the study seem to support this concern. Whilst there is beginning discontinuity noted between intervention and control groups after one year of intervention, the difference is not significant enough to be able to associate this effect on the MCCT program. This can be partly explained by a relatively short period of exposure to be able to make an impact on stunting/stuntedness. But it is also explained by the low coverage achieved by the program currently.

Given this, it is critical that the MCCT program achieve high levels of coverage as an immediate point of action. Secondly, other factors that a cash transfer program will most likley not impact should be considered for other types of interventions. This includes efforts to improve water, sanitation and hygiene services particularly in hard-to-reach and in poor households. Social and behavioural change communication, a component of the current intervention, also has a role in impacting on diet-related practices specifically on infant and young child feeding and in addition it should include key messages on appropriate hygiene practices and treatment-seeking practices based on nuanced and contextualised understanding of existing practices and behaviours.

# References {-}



[^1]: Based on the earlier Chin assessment and based on feedback from various stakeholders.

[^2]: Based on 2015 Myanmar Demographic and Health Survey [@MinistryofHealthandSports-MoHS/Myanmar2017]

[^3]: See https://ona.io

[^4]: See https://validmeasures.io/myanmarMCCTchecks

[^5]: Can be downloaded from the [Comprehensive R Archive Network](https://cran.r-project.org) where guidance on installing R is also available.

[^6]: See https://validmeasures.org/myanmarMCCTdata to learn more about the **myanmarMCCTdata** package and how data is handled and processed using this package.

[^7]: For a full list of other R packages that **myanmarMCCTdata** depends on, see https://validmeasures.org/myanmarMCCTdata

[^8]: Time to collect water from reported water source was not collected in baseline survey. The access to improved drinking water sources indicator does not take time into account. This indicator can be reframed as at least limited access to improved drinking water sources taking into account the definitions for limited and basic drinking water service.

[^9]: This is termed as access to **basic** sanitation facilities as per current indicator definitions.

[^10]: This is termed as access to **limited** sanitation facilities as per current indicator definitions.

[^11]: This is termed as access to **basic** handwashing facilities as per current indicator definitions.

[^12]: This is termed as access to **limited** handwashing facilities as per current indicator definitions.

[^13]: Fever is used as a proxy for illnesses due to an infection such as malaria

[^14]: Cough is used as a proxy for an acute respiratory infection (ARI)

[^15]: See https://nutriverse.io/zscorer for details on how the z-scores are calculated

[^16]: See https://nutriverse.io/nutricheckr for details on how the flagging criteria is applied

[^17]: See https://nutriverse.io/nipnTK for details on how anthropometric data quality check is performed using the **nipnTK** R package



